

æ»‘åŠ¨çª—å£å’Œå‰ç¼€å’Œä¸»è¦ç”¨æ¥å¤„ç†è¿ç»­é—®é¢˜ã€‚æ¯”å¦‚**é¢˜ç›®æ±‚è§£â€œè¿ç»­å­ä¸² xxxxâ€ï¼Œâ€œè¿ç»­å­æ•°ç»„ xxxxâ€ã€‚**äºŒè€…åœ¨è¿ç»­é—®é¢˜ä¸­ï¼Œå¯¹äº**ä¼˜åŒ–æ—¶é—´å¤æ‚åº¦**æœ‰ç€å¾ˆé‡è¦çš„æ„ä¹‰ã€‚ å› æ­¤å¦‚æœä¸€é“é¢˜ä½ å¯ä»¥ç”¨æš´åŠ›è§£å†³å‡ºæ¥ï¼Œè€Œä¸”é¢˜ç›®æ°å¥½æœ‰è¿ç»­çš„é™åˆ¶ï¼Œ é‚£ä¹ˆæ»‘åŠ¨çª—å£å’Œå‰ç¼€å’Œç­‰æŠ€å·§å°±åº”è¯¥è¢«æƒ³åˆ°ã€‚

# æ»‘åŠ¨çª—å£

## åŸºæœ¬çŸ¥è¯†

æ»‘åŠ¨çª—å£å±äºåŒæŒ‡é’ˆåº”ç”¨çš„ä¸€ç§åœºæ™¯ã€‚

**æ‰€ä»¥ä»Šå¤©æˆ‘å°±å†™ä¸€å¥—æ»‘åŠ¨çª—å£ç®—æ³•çš„ä»£ç æ¡†æ¶ï¼Œæˆ‘è¿å†å“ªé‡Œåšè¾“å‡º debug éƒ½ç»™ä½ å†™å¥½äº†ï¼Œä»¥åé‡åˆ°ç›¸å…³çš„é—®é¢˜ï¼Œä½ å°±é»˜å†™å‡ºæ¥å¦‚ä¸‹æ¡†æ¶ç„¶åæ”¹ä¸‰ä¸ªåœ°æ–¹å°±è¡Œ**ï¼š

```c
/* æ»‘åŠ¨çª—å£ç®—æ³•æ¡†æ¶ */
void slidingWindow(string s, string t) {
    unordered_map<char, int> need, window;
    for (char c : t) need[c]++;

    int left = 0;
    int valid = 0; 
    while (int right = 0;right < s.size();right++) {
        // c æ˜¯å°†ç§»å…¥çª—å£çš„å­—ç¬¦
        char c = s[right];
        // è¿›è¡Œçª—å£å†…æ•°æ®çš„ä¸€ç³»åˆ—æ›´æ–°
        add(c);

        /*** debug è¾“å‡ºçš„ä½ç½® ***/
        printf("window: [%d, %d)\n", left, right);
        /********************/

        // åˆ¤æ–­å·¦ä¾§çª—å£æ˜¯å¦è¦æ”¶ç¼©
        while (window needs shrink) {
            // d æ˜¯å°†ç§»å‡ºçª—å£çš„å­—ç¬¦
            char d = s[left];
            // å·¦ç§»çª—å£
            left++;
            // è¿›è¡Œçª—å£å†…æ•°æ®çš„ä¸€ç³»åˆ—æ›´æ–°
            remove(d);
        }
    }
}
```

**åœ¨å¼€å§‹å¥—æ¨¡æ¿æ—¶ï¼Œéœ€è¦æ€è€ƒä»¥ä¸‹å››ä¸ªé—®é¢˜**ï¼š

1ã€å½“ç§»åŠ¨ `right` æ‰©å¤§çª—å£ï¼Œå³åŠ å…¥å­—ç¬¦æ—¶ï¼Œåº”è¯¥æ›´æ–°å“ªäº›æ•°æ®ï¼Ÿ

2ã€ä»€ä¹ˆæ¡ä»¶ä¸‹ï¼Œå¼€å§‹ç§»åŠ¨ `left` ç¼©å°çª—å£ï¼Ÿ

3ã€å½“ç§»åŠ¨ `left` ç¼©å°çª—å£ï¼Œå³ç§»å‡ºå­—ç¬¦æ—¶ï¼Œåº”è¯¥æ›´æ–°å“ªäº›æ•°æ®ï¼Ÿ

4ã€**æˆ‘ä»¬è¦çš„ç»“æœåº”è¯¥åœ¨æ‰©å¤§çª—å£æ—¶è¿˜æ˜¯ç¼©å°çª—å£æ—¶è¿›è¡Œæ›´æ–°ï¼Ÿ**



**å…¶ä¸­ä¸¤å¤„** `add(ch)`å’Œ`romove(ch)`**è¡¨ç¤ºçš„æ›´æ–°çª—å£æ•°æ®çš„åœ°æ–¹ï¼Œåˆ°æ—¶å€™ä½ ç›´æ¥å¾€é‡Œé¢å¡«å°±è¡Œäº†**,ç­‰ä¼šä½ ä¼šå‘ç°å®ƒä»¬æ“ä½œæ˜¯å®Œå…¨å¯¹ç§°çš„ã€‚

å¯¹äºä¸76.æœ€å°è¦†ç›–å­ä¸²ç±»ä¼¼çš„å­ä¸²é—®é¢˜ï¼Œæ›´æ–°çª—å£æ•°æ®çš„ä¼ªä»£ç å¦‚ä¸‹ï¼š

```c
class Window{ 
    unordered_map<char, int> needs; //needsåŒ…å«äº†å¦å¤–ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„æ‰€æœ‰å­—ç¬¦ï¼Œæ˜¯windowè¦è¾¾åˆ°çš„ç›®æ ‡
    unordered_map<char, int> window; // windowä¸æ–­é€¼è¿‘needs
    int match = 0; // matchè®°å½•windowä¸needsç›¸ç­‰çš„å…ƒç´ ä¸ªæ•°
    
    void add(char c1){ //æ›´æ–°çª—å£æ•°æ®
        window[c1]++;
        if (needs.count(c1) && window[c1] == needs[c1]) {
            match++;
        }
    }
    void remove(char c2){//æ›´æ–°çª—å£æ•°æ®
        window[c2]--;
        if (needs.count(c2) && window[c2] < needs[c2]) {
			match--;	  
        }
    }
}
```

## åº”ç”¨

#### [76.æœ€å°è¦†ç›–å­ä¸²](https://leetcode-cn.com/problems/minimum-window-substring)                                                                                     

ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² s ã€ä¸€ä¸ªå­—ç¬¦ä¸² t ã€‚è¿”å› s ä¸­æ¶µç›– t æ‰€æœ‰å­—ç¬¦çš„æœ€å°å­ä¸²ã€‚

å¦‚æœ s ä¸­ä¸å­˜åœ¨æ¶µç›– t æ‰€æœ‰å­—ç¬¦çš„å­ä¸²ï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸² "" ã€‚

æ³¨æ„ï¼šå¦‚æœ s ä¸­å­˜åœ¨è¿™æ ·çš„å­ä¸²ï¼Œæˆ‘ä»¬ä¿è¯å®ƒæ˜¯å”¯ä¸€çš„ç­”æ¡ˆã€‚

 **æç¤ºï¼š**

- `1 <= s.length, t.length <= 10^5`

ç¤ºä¾‹ 1ï¼š

è¾“å…¥ï¼šs = "ADOBECODEBANC", t = "ABC"
è¾“å‡ºï¼š"BANC"

---



åˆ†æï¼š

æ±‚ä¸€ä¸ªå­—ç¬¦ä¸²çš„å­ä¸²è¦†ç›–å¦ä¸€ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦ä¸€å®šæ˜¯é—®ã€Œæœ€å°ã€ï¼Œè€Œä¸ä¼šé—®ã€Œæœ€å¤§ã€ï¼Œå› ä¸ºæœ€å¤§ä¸€å®šæ˜¯æ•´ä¸ªå­—ç¬¦ä¸²ï¼›

æ ¹æ®é¢˜æ„,**æ»‘åŠ¨çª—å£ç®—æ³•çš„æ€è·¯æ˜¯è¿™æ ·**ï¼š

1.çª—å£åˆå§‹åŒ– `left = right = 0`ï¼Œçª—å£ä¸º[left,right];

2.å…ˆä½¿ç”¨rightæŒ‡é’ˆæ‰©å¤§çª—å£ï¼›

3.å½“çª—å£ä¸­çš„å­—ç¬¦ä¸²ç¬¦åˆè¦æ±‚ï¼ˆåŒ…å«äº† `T` ä¸­çš„æ‰€æœ‰å­—ç¬¦ï¼‰æ—¶ï¼Œä½¿ç”¨leftæŒ‡é’ˆç¼©å°çª—å£ï¼Œç›´åˆ°çª—å£ä¸­çš„å­—ç¬¦ä¸²ä¸å†ç¬¦åˆè¦æ±‚ï¼ˆä¸åŒ…å« `T` ä¸­çš„æ‰€æœ‰å­—ç¬¦äº†ï¼‰ï¼Œåœ¨çª—å£ç¼©å°çš„åŒæ—¶ä¸æ–­æ›´æ–°**æœ€ä¼˜è§£**ã€‚

4.é‡å¤ç¬¬ 2 å’Œç¬¬ 3 æ­¥ï¼Œç›´åˆ° `right` åˆ°è¾¾å­—ç¬¦ä¸² `S` çš„å°½å¤´ã€‚



**ç°åœ¨å¼€å§‹å¥—æ¨¡æ¿ï¼Œåªéœ€è¦æ€è€ƒä»¥ä¸‹å››ä¸ªé—®é¢˜**ï¼š

1ã€å½“ç§»åŠ¨ `right` æ‰©å¤§çª—å£ï¼Œå³åŠ å…¥å­—ç¬¦æ—¶ï¼Œåº”è¯¥æ›´æ–°å“ªäº›æ•°æ®ï¼Ÿ

2ã€ä»€ä¹ˆæ¡ä»¶ä¸‹ï¼Œå¼€å§‹ç§»åŠ¨ `left` ç¼©å°çª—å£ï¼Ÿ

3ã€å½“ç§»åŠ¨ `left` ç¼©å°çª—å£ï¼Œå³ç§»å‡ºå­—ç¬¦æ—¶ï¼Œåº”è¯¥æ›´æ–°å“ªäº›æ•°æ®ï¼Ÿ

4ã€**æˆ‘ä»¬è¦çš„ç»“æœåº”è¯¥åœ¨æ‰©å¤§çª—å£æ—¶è¿˜æ˜¯ç¼©å°çª—å£æ—¶è¿›è¡Œæ›´æ–°ï¼Ÿ**

å¦‚æœä¸€ä¸ªå­—ç¬¦è¿›å…¥çª—å£ï¼Œåº”è¯¥å¢åŠ  `window` è®¡æ•°å™¨ï¼›å¦‚æœä¸€ä¸ªå­—ç¬¦å°†ç§»å‡ºçª—å£çš„æ—¶å€™ï¼Œåº”è¯¥å‡å°‘ `window` è®¡æ•°å™¨ï¼›å½“ `valid` æ»¡è¶³ `need` æ—¶åº”è¯¥æ”¶ç¼©çª—å£ï¼›åº”è¯¥åœ¨æ”¶ç¼©çª—å£çš„æ—¶å€™æ›´æ–°æœ€ç»ˆç»“æœã€‚

å®Œæ•´ä»£ç 

```c
class Solution {
public:
    string minWindow(string s, string t)
    {
        unordered_map<char, int> need, window;
        for (char c : t)
            need[c]++;

        int valid = 0;
        // è®°å½•æœ€å°è¦†ç›–å­ä¸²çš„èµ·å§‹ç´¢å¼•åŠé•¿åº¦
        int start = 0, len = INT_MAX;
        for (int left = 0, right = 0; right < s.size(); right++) {
            char c = s[right];
            // è¿›è¡Œçª—å£å†…æ•°æ®çš„ä¸€ç³»åˆ—æ›´æ–°
            window[c]++;
            if (need.count(c) && need[c] == window[c]) {
                valid++;
            }
            // åˆ¤æ–­å·¦ä¾§çª—å£æ˜¯å¦è¦æ”¶ç¼©
            while (valid == need.size()) {
                // åœ¨è¿™é‡Œæ›´æ–°æœ€å°è¦†ç›–å­ä¸²
                if (right - left + 1 < len) {
                    len = right - left + 1;
                    start = left;
                }
                char d = s[left];
                // è¿›è¡Œçª—å£å†…æ•°æ®çš„ä¸€ç³»åˆ—æ›´æ–°
                window[d]--;
                if (need.count(d) && need[d] > window[d]) {
                    valid--;
                }
                left++;
            }
        }
        // è¿”å›æœ€å°è¦†ç›–å­ä¸²
        return len == INT_MAX ? "" : s.substr(start, len);
    }
};
```

**å¯ä»¥çœ‹åˆ°ï¼Œä¸¤æ¬¡å¯¹çª—å£å†…æ•°æ®çš„æ›´æ–°æ“ä½œæ˜¯å®Œå…¨å¯¹ç§°çš„ã€‚**

#### [567.å­—ç¬¦ä¸²çš„æ’åˆ—](https://leetcode-cn.com/problems/permutation-in-string)

ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸² tå’Œ sï¼Œå†™ä¸€ä¸ªå‡½æ•°æ¥åˆ¤æ–­ sæ˜¯å¦åŒ…å« tçš„æ’åˆ—ã€‚

æ¢å¥è¯è¯´ï¼Œç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²çš„æ’åˆ—ä¹‹ä¸€æ˜¯ç¬¬äºŒä¸ªå­—ç¬¦ä¸²çš„ å­ä¸² ã€‚

 **æç¤ºï¼š**

- ä¸¤ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦éƒ½åœ¨ `[1, 10,000]` ä¹‹é—´

ç¤ºä¾‹ 1ï¼š

è¾“å…¥: t= "ab" s= "eidbaooo"
è¾“å‡º: True
è§£é‡Š: såŒ…å« tçš„æ’åˆ—ä¹‹ä¸€ ("ba").

---

æ ¹æ®é¢˜æ„,**æ»‘åŠ¨çª—å£ç®—æ³•çš„æ€è·¯æ˜¯è¿™æ ·**ï¼š

1.çª—å£åˆå§‹åŒ– `left = right = 0`ï¼Œçª—å£ä¸º[left,right];

2.å…ˆä½¿ç”¨rightæŒ‡é’ˆæ‰©å¤§çª—å£;

3.å½“çª—å£ä¸­çš„å­—ç¬¦ä¸²ç¬¦åˆè¦æ±‚(åŒ…å«äº†tçš„æ‰€æœ‰å­—ç¬¦)æ—¶ï¼Œä½¿ç”¨leftæŒ‡é’ˆç¼©å°çª—å£ï¼Œç›´åˆ°çª—å£ä¸­çš„å­—ç¬¦ä¸²ä¸å†ç¬¦åˆè¦æ±‚(æ²¡æœ‰åŒ…å«tçš„æ‰€æœ‰å­—ç¬¦)ï¼Œåœ¨çª—å£ç¼©å°çš„åŒæ—¶åˆ¤æ–­çª—å£å­—ç¬¦ä¸²æ˜¯å¦ç­‰äºtçš„æ’åˆ—ï¼Œå¦‚æœç›¸ç­‰åˆ™è¿”å›trueã€‚



```c
class Solution {
public:
    // åˆ¤æ–­ s ä¸­æ˜¯å¦å­˜åœ¨ t çš„æ’åˆ—
    bool checkInclusion(string t, string s)
    {
        unordered_map<char, int> need, window;
        for (char c : t)
            need[c]++;

        int valid = 0;
        for (int left = 0, right = 0; right < s.size(); right++) {
            char c = s[right];
            window[c]++;
            if (need.count(c) && need[c] == window[c]) {
                valid++;
            }
            while (valid == need.size()) {
                // åœ¨è¿™é‡Œåˆ¤æ–­æ˜¯å¦æ‰¾åˆ°äº†åˆæ³•çš„å­ä¸²
                if (right - left + 1 == t.size()) {
                    return true;
                }
                char d = s[left];
                window[d]--;
                if (need.count(d) && need[d] > window[d]) {
                    valid--;
                }
                left++;
            }
        }
        // æœªæ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„å­ä¸²
        return false;
    }
};
```

#### [3.æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²](https://leetcode-cn.com/problems/longest-substring-without-repeating-characters)

ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¯·ä½ æ‰¾å‡ºå…¶ä¸­ä¸å«æœ‰é‡å¤å­—ç¬¦çš„ æœ€é•¿å­ä¸² çš„é•¿åº¦ã€‚

 

ç¤ºä¾‹ 1:

è¾“å…¥: s = "abcabcbb"
è¾“å‡º: 3 
è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ "abc"ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 3ã€‚

---

é¢˜ç›®åˆ†æï¼šæ²¡æœ‰é‡å¤çš„å­ä¸²ï¼Œä¸€å®šåªä¼šé—®ã€Œæœ€é•¿ã€ï¼Œå› ä¸ºæœ€çŸ­çš„æ²¡æœ‰é‡å¤å­—ç¬¦çš„å­ä¸²æ˜¯åªæœ‰ä¸€ä¸ªå­—ç¬¦çš„å­ä¸²ï¼›

æ ¹æ®é¢˜æ„,**æ»‘åŠ¨çª—å£ç®—æ³•çš„æ€è·¯æ˜¯è¿™æ ·**ï¼š

1.çª—å£åˆå§‹åŒ– `left = right = 0`ï¼Œçª—å£ä¸º[left,right];

2.å…ˆä½¿ç”¨rightæŒ‡é’ˆæ‰©å¤§çª—å£ï¼›

3.å½“çª—å£ä¸­çš„å­—ç¬¦ä¸²ä¸ç¬¦åˆæ¡ä»¶(`window[c]` å€¼å¤§äº 1 æ—¶ï¼Œè¯´æ˜çª—å£ä¸­å­˜åœ¨é‡å¤å­—ç¬¦)æ—¶ï¼Œä½¿ç”¨leftæŒ‡é’ˆç¼©å°çª—å£ï¼Œç›´åˆ°çª—å£ä¸­çš„å­—ç¬¦ä¸²ç¬¦åˆè¦æ±‚ï¼ˆä¸åŒ…å«é‡å¤å­—ç¬¦ï¼‰ï¼Œ**æ”¶ç¼©çª—å£å®Œæˆåæ›´æ–°res**ï¼›

4.é‡å¤ç¬¬ 2 å’Œç¬¬ 3 æ­¥ï¼Œç›´åˆ° `right` åˆ°è¾¾å­—ç¬¦ä¸² `S` çš„å°½å¤´ã€‚

```c
class Solution {
public:
    int lengthOfLongestSubstring(string s)
    {
        unordered_map<char, int> need, window;
        int ret = 0;
        for (int left = 0, right = 0; right < s.size(); right++) {
            char c = s[right];
            window[c]++;
			// åˆ¤æ–­å·¦ä¾§çª—å£æ˜¯å¦è¦æ”¶ç¼©
            while (window[c] > 1) {
                char c2 = s[left];
                window[c2]--;
                left++;
            }
            // åœ¨è¿™é‡Œæ›´æ–°ç­”æ¡ˆ
            ret = ret > right - left + 1 ? ret : right - left + 1;
            cout << "left=" << left << ",right=" << right << ",ret=" << ret << endl;
        }
        return ret;
    }
};
```



# å‰ç¼€å’Œæ•°ç»„

**å‰ç¼€å’Œä¸»è¦é€‚ç”¨çš„åœºæ™¯æ˜¯åŸå§‹æ•°ç»„ä¸ä¼šè¢«ä¿®æ”¹çš„æƒ…å†µä¸‹ï¼Œé¢‘ç¹æŸ¥è¯¢æŸä¸ªåŒºé—´çš„ç´¯åŠ å’Œ**ã€‚

ä¸€èˆ¬ç”¨æ¥æ±‚å­æ•°ç»„ä¸ªæ•°ã€‚

## æ¨¡æ¿

### æ¯é¢˜ 0-å‰ç¼€å’Œ

æœ‰ N ä¸ªçš„æ­£æ•´æ•°æ”¾åˆ°æ•°ç»„ A é‡Œï¼Œç°åœ¨è¦æ±‚ä¸€ä¸ªæ–°çš„æ•°ç»„ Bï¼Œæ–°æ•°ç»„çš„ç¬¬ i ä¸ªæ•° B[i]æ˜¯åŸæ•°ç»„ A ç¬¬ 0 åˆ°ç¬¬ i ä¸ªæ•°çš„å’Œã€‚

**å‰ç¼€å’Œï¼šâ€œæ•°åˆ—çš„å‰ n é¡¹çš„å’Œâ€**

å¯¹ [1,2,3,4,5,6] æ¥è¯´ï¼Œå…¶å‰ç¼€å’Œå¯ä»¥æ˜¯ pre=[1,3,6,10,15,21]ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¬å¼ pre[ğ‘–]=pre[ğ‘–âˆ’1]+nums[ğ‘–]å¾—åˆ°

```java
class PrefixSum {
    // å‰ç¼€å’Œæ•°ç»„
    private int[] preSum;

    /* è¾“å…¥ä¸€ä¸ªæ•°ç»„ï¼Œæ„é€ å‰ç¼€å’Œ */
    public PrefixSum(int[] nums) {
        preSum = new int[nums.length];
        for (int i = 1; i < nums.length; i++) {
            preSum[i] = i == 0 ? nums[i] : preSum[i - 1] + nums[i];
        }
    }

    /* æŸ¥è¯¢é—­åŒºé—´ [i, j] çš„ç´¯åŠ å’Œ */
    public int query(int i, int j) {
        return preSum[j] - preSum[i - 1];
    }
}
```

è¿™ä¸ªå‰ç¼€å’Œæ•°ç»„ `preSum` çš„å«ä¹‰ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œ`preSum[i]` å°±æ˜¯ `nums[0..i]` çš„å’Œã€‚é‚£ä¹ˆå¦‚æœæˆ‘ä»¬æƒ³æ±‚ `nums[j...i]` çš„å’Œï¼Œåªéœ€è¦ä¸€æ­¥æ“ä½œ `preSum[i]-preSum[j-1]` å³å¯ï¼Œè€Œä¸éœ€è¦é‡æ–°å»éå†æ•°ç»„äº†ã€‚

### æ¯é¢˜ 1-è¿ç»­å­æ•°ç»„ä¸ªæ•°

> å¦‚æœè®©ä½ æ±‚ä¸€ä¸ªæ•°ç»„çš„è¿ç»­å­æ•°ç»„æ€»ä¸ªæ•°ï¼Œä½ ä¼šå¦‚ä½•æ±‚ï¼Ÿ

å…¶ä¸­è¿ç»­æŒ‡çš„æ˜¯æ•°ç»„çš„ç´¢å¼•è¿ç»­ã€‚ æ¯”å¦‚ [1,3,4]ï¼Œå…¶è¿ç»­å­æ•°ç»„æœ‰ï¼š`[1], [3], [4], [1,3], [3,4] , [1,3,4]`ï¼Œä½ éœ€è¦è¿”å› 6ã€‚

ä¸€ç§æ€è·¯æ˜¯æ€»çš„è¿ç»­å­æ•°ç»„ä¸ªæ•°ç­‰äºï¼š**ä»¥ç´¢å¼•ä¸º 0 ç»“å°¾çš„å­æ•°ç»„ä¸ªæ•° + ä»¥ç´¢å¼•ä¸º 1 ç»“å°¾çš„å­æ•°ç»„ä¸ªæ•° + ... + ä»¥ç´¢å¼•ä¸º n - 1 ç»“å°¾çš„å­æ•°ç»„ä¸ªæ•°**ï¼Œè¿™æ— ç–‘æ˜¯å®Œå¤‡çš„ã€‚

![img](assets/007S8ZIlly1gj6m27kgbsj306u06gt8u.jpg)

åŒæ—¶**åˆ©ç”¨æ¯é¢˜ 0 çš„å‰ç¼€å’Œæ€è·¯ï¼Œ è¾¹éå†è¾¹æ±‚å’Œã€‚**

ï¼ˆç›¸å½“äºå¯¹[1,2,3]æ±‚å‰ç¼€å’Œï¼‰

```js
function countSubArray(nums) {
  let ans = 0;
  let pre = 0;
  for (_ in nums) {
    pre += 1;
    ans += pre;
  }
  return ans;
}
```

è€Œç”±äºä»¥ç´¢å¼•ä¸º i ç»“å°¾çš„å­æ•°ç»„ä¸ªæ•°å°±æ˜¯ i + 1ï¼Œå› æ­¤è¿™é“é¢˜å¯ä»¥ç›´æ¥ç”¨**ç­‰å·®æ•°åˆ—**æ±‚å’Œå…¬å¼

 `(1 + n) * n / 2`ï¼Œå…¶ä¸­ n æ•°ç»„é•¿åº¦ã€‚

### æ¯é¢˜ 2-ç›¸é‚»å·®å€¼ä¸º 1 è¿ç»­å­æ•°ç»„ä¸ªæ•°

>  å¦‚æœè®©ä½ æ±‚ä¸€ä¸ªæ•°ç»„ç›¸é‚»å·®ä¸º 1 è¿ç»­å­æ•°ç»„çš„æ€»ä¸ªæ•°å‘¢ï¼Ÿå…¶å®å°±æ˜¯**ç´¢å¼•å·® 1 çš„åŒæ—¶ï¼Œå€¼ä¹Ÿå·® 1ã€‚**

å’Œä¸Šé¢æ€è·¯ç±»ä¼¼ï¼Œæ— éå°±æ˜¯å¢åŠ å·®å€¼çš„åˆ¤æ–­ã€‚

```js
function countSubArray(nums) {
  let ans = 1;
  let pre = 1;
  for (let i = 1; i < nums.length; i++) {
    if (nums[i] - nums[i - 1] == 1) {
      pre += 1;
    } else {
      pre = 1;
    }

    ans += pre;
  }
  return ans;
}
```

å¦ä¸€ç§å†™æ³•ï¼š

```java
int countSubArray(nums)
{
    int ans = 0;
    int pre = 1;
    for (int i = 0; i < nums.length; i++) {
        if (i > 0 && nums[i] - nums[i - 1] == 1) {
            pre ++;
        } else {
            pre = 1;
        }
        ans += pre;
    }
    return ans;
}
```

> å¦‚æœæˆ‘å€¼å·®åªè¦å¤§äº 1 å°±è¡Œå‘¢ï¼Ÿå…¶å®æ”¹ä¸‹ç¬¦å·å°±è¡Œäº†ï¼Œè¿™ä¸å°±æ˜¯æ±‚ä¸Šå‡å­åºåˆ—ä¸ªæ•°ä¹ˆï¼Ÿ

```java
int countSubArray(nums)
{
    int ans = 0;
    int pre = 1;
    for (int i = 0; i < nums.length; i++) {
        if (i > 0 && nums[i] - nums[i - 1] > 1) {
            pre++;
        } else {
            pre = 1;
        }
        ans += pre;
    }
    return ans;
}
```

æˆ–è€…ä¹Ÿå¯ä»¥æŒ‰ç…§dpçš„å†™æ³•ï¼ŒåŒºåˆ«æ˜¯dpç©ºé—´å¤æ‚åº¦ä¸ºO(n)ã€‚

```c
int countSubArray(nums)
{
    int[] dp = new int [nums.length]; //[0,i]å·¦è¾¹èŒƒå›´å†…æœ‰dp[i]ä¸ªä¸Šå‡å­åºåˆ—
    int pre = 1;
    dp[0] = 1;
    for (int i = 1; i < nums.length; i++) {
        if (i > 0 && nums[i] - nums[i - 1] > 1) {
            pre++;
        } else {
            pre = 1;
        }
        dp[i] = dp[i-1] + pre;
    }
    return  dp[nums.lenght-1];
}
```





### æ¯é¢˜ 3-ä¸å¤§äº k çš„è¿ç»­å­æ•°ç»„ä¸ªæ•°

> å¦‚æœæˆ‘è®©ä½ æ±‚å‡ºä¸å¤§äº k çš„è¿ç»­å­æ•°ç»„çš„ä¸ªæ•°å‘¢ï¼Ÿ

ä¸å¤§äº k æŒ‡çš„æ˜¯å­æ•°ç»„çš„å…¨éƒ¨å…ƒç´ éƒ½ä¸å¤§äº kã€‚ æ¯”å¦‚ [1,3,4] å­æ•°ç»„æœ‰ `[1], [3], [4], [1,3], [3,4] , [1,3,4]`ï¼Œä¸å¤§äº 3 çš„å­æ•°ç»„æœ‰ `[1], [3], [1,3]` ï¼Œé‚£ä¹ˆ [1,3,4] ä¸å¤§äº 3 çš„å­æ•°ç»„ä¸ªæ•°å°±æ˜¯ 3ã€‚ å®ç°å‡½æ•° atMostK(k, nums)ã€‚

```js
function atMostK(k, nums) {
  let ans = 0;
  let pre = 0;
  for (let i = 0; i < nums.length; i++) {
    if (nums[i] <= k) {
      pre += 1;
    } else {
      pre = 0;
    }

    ans += pre;
  }
  return ans;
}
```

### æ¯é¢˜ 4-æœ€å¤§å€¼ä¸ºkçš„è¿ç»­å­æ•°ç»„ä¸ªæ•°

> å¦‚æœæˆ‘è®©ä½ æ±‚å‡ºå­æ•°ç»„æœ€å¤§å€¼åˆšå¥½æ˜¯ k çš„å­æ•°ç»„çš„ä¸ªæ•°å‘¢ï¼Ÿ

```c
int exactK(k, nums){
    return atMostK(k,nums) - atMostK(k - 1,nums);
}
```

### æ¯é¢˜ 5-æœ€å¤§å€¼ä»‹äº[k1,k2]çš„è¿ç»­å­æ•°ç»„ä¸ªæ•°

> å¦‚æœæˆ‘è®©ä½ æ±‚å‡ºå­æ•°ç»„æœ€å¤§å€¼åˆšå¥½æ˜¯ ä»‹äº k1 å’Œ k2 çš„å­æ•°ç»„çš„ä¸ªæ•°å‘¢ï¼Ÿ k2<=num<=k1

<img src="assets/007S8ZIlly1gj8m692laxj30pz0grte9.jpg" alt="img" style="zoom: 33%;" />

å¦‚ä¸Šï¼Œ`å°äºç­‰äº 10 çš„åŒºåŸŸ`å‡å» `å°äº 5 çš„åŒºåŸŸ`å°±æ˜¯ `å¤§äºç­‰äº 5 ä¸”å°äºç­‰äº 10 çš„åŒºåŸŸ`

```c
int betweenK(k1, k2, nums){
    return atMostK(k1,nums) - atMostK(k2 - 1,nums);
}
```

ä¸éš¾çœ‹å‡º exactK å…¶å®å°±æ˜¯ betweenK çš„ç‰¹æ®Šå½¢å¼ã€‚ å½“ k1 == k2 çš„æ—¶å€™ï¼Œ betweenK ç­‰ä»·äº exactKã€‚

## åº”ç”¨

#### [53. æœ€å¤§å­åºå’Œ](https://leetcode-cn.com/problems/maximum-subarray/)

ç»™å®šâ¼€ä¸ªæ•´æ•°æ•°ç»„nums ï¼Œæ‰¾åˆ°â¼€ä¸ªå…·æœ‰æœ€â¼¤å’Œçš„è¿ç»­â¼¦æ•°ç»„ï¼ˆâ¼¦æ•°ç»„**æœ€å°‘åŒ…å«â¼€ä¸ªå…ƒç´ **ï¼‰ï¼Œè¿”å›å…¶æœ€â¼¤å’Œã€‚è¾“â¼Š: [-2,1,-3,4,-1,2,1,-5,4] è¾“å‡º: 6

è§£æ³•ä¸‰ï¼šåŠ¨æ€è§„åˆ’

dp[i]è¡¨ç¤ºä»¥ç´¢å¼• i ç»“å°¾çš„æƒ…å†µä¸‹çš„æœ€å¤§å­åºåˆ—å’Œ

åˆ™`dp[i] = Math.max(dp[i-1]+ nums[i], nums[i]) ;`

åˆå§‹åŒ–ï¼š`dp[i] = nums[0];`

ä»£ç ï¼š

```c
class Solution {
    public int maxSubArray(int[] nums) {
        int[] dp = new int[nums.length];
        dp[0] = nums[0];
        int ret = dp[0];
        for (int i = 1; i < nums.length; i++) {
            dp[i] = Math.max(dp[i-1]+ nums[i], nums[i]);
            ret = Math.max(ret, dp[i]);
        }
        return ret;
    }
}
```

- æ—¶é—´å¤æ‚åº¦ï¼šO(n)

å¯ä»¥çœ‹åˆ°`dp[i]`åªä¾èµ–å‰ä¸€ä¸ªå€¼`dp[i-1]`ï¼Œå› æ­¤å¯ä»¥è¿›è¡ŒçŠ¶æ€å‹ç¼©ï¼Œå¾—åˆ°ç©ºé—´å¤æ‚åº¦ä¸ºO(1)çš„æ»šåŠ¨æ•°ç»„è§£æ³•ã€‚

```c
class Solution {
    public int maxSubArray(int[] nums) {
        int pre = 0;
        int ret = nums[0];
        for (int i = 0; i < nums.length; i++) {
            pre = Math.max(pre+ nums[i], nums[i]);
            ret = Math.max(ret, pre);
        }
        return ret;
    }
}
```

å°†è¿™ç§åšæ³•è§£é‡Šæˆè´ªå¿ƒç®—æ³•ï¼Œæ„Ÿè§‰è¿˜æ˜¯æœ‰ç‚¹ç‰µå¼ºçš„ã€‚

è§£æ³•äºŒï¼šåˆ†æ²»æ³•

æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹è¿™ä¸ªé—®é¢˜ï¼Œ æˆ‘ä»¬å…ˆæŠŠæ•°ç»„å¹³å‡åˆ†æˆå·¦å³ä¸¤éƒ¨åˆ†ã€‚

æ­¤æ—¶æœ‰ä¸‰ç§æƒ…å†µï¼š

- æœ€å¤§å­åºåˆ—å…¨éƒ¨åœ¨æ•°ç»„å·¦éƒ¨åˆ†
- æœ€å¤§å­åºåˆ—å…¨éƒ¨åœ¨æ•°ç»„å³éƒ¨åˆ†
- æœ€å¤§å­åºåˆ—æ¨ªè·¨å·¦å³æ•°ç»„

å¯¹äºå‰ä¸¤ç§æƒ…å†µï¼Œæˆ‘ä»¬ç›¸å½“äºå°†åŸé—®é¢˜è½¬åŒ–ä¸ºäº†è§„æ¨¡æ›´å°çš„åŒæ ·é—®é¢˜ã€‚

å¯¹äºç¬¬ä¸‰ç§æƒ…å†µï¼Œç”±äºå·²çŸ¥å¾ªç¯çš„èµ·ç‚¹ï¼ˆå³ä¸­ç‚¹ï¼‰ï¼Œæˆ‘ä»¬åªéœ€è¦è¿›è¡Œä¸€æ¬¡å¾ªç¯ï¼Œåˆ†åˆ«æ‰¾å‡º å·¦è¾¹å’Œå³è¾¹çš„æœ€å¤§å­åºåˆ—å³å¯ã€‚

æ‰€ä»¥ä¸€ä¸ªæ€è·¯å°±æ˜¯æˆ‘ä»¬æ¯æ¬¡éƒ½å¯¹æ•°ç»„åˆ†æˆå·¦å³ä¸¤éƒ¨åˆ†ï¼Œç„¶ååˆ†åˆ«è®¡ç®—ä¸Šé¢ä¸‰ç§æƒ…å†µçš„æœ€å¤§å­åºåˆ—å’Œï¼Œ å–å‡ºæœ€å¤§çš„å³å¯ã€‚

 

è¿™ç§åšæ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º O(N*logN), ç©ºé—´å¤æ‚åº¦ä¸º O(1)ã€‚

```c
class MaximumSubarrayDivideConquer {
  public int maxSubArrayDividConquer(int[] nums) {
      if (nums == null || nums.length == 0) return 0;
      return helper(nums, 0, nums.length - 1);
    }
    private int helper(int[] nums, int l, int r) {
      if (l > r) return Integer.MIN_VALUE;
      int mid = (l + r) >> 1;
      int left = helper(nums, l, mid - 1);
      int right = helper(nums, mid + 1, r);
      int leftMaxSum = 0;
      int sum = 0;
      // left surfix maxSum start from index mid - 1 to l
      for (int i = mid - 1; i >= l; i--) {
        sum += nums[i];
        leftMaxSum = Math.max(leftMaxSum, sum);
      }
      int rightMaxSum = 0;
      sum = 0;
      // right prefix maxSum start from index mid + 1 to r
      for (int i = mid + 1; i <= r; i++) {
        sum += nums[i];
        rightMaxSum = Math.max(sum, rightMaxSum);
      }
      // max(left, right, crossSum)
      return Math.max(leftMaxSum + rightMaxSum + nums[mid], Math.max(left, right));
    }
}
```

è§£æ³•å››ã€æ•°å­¦åˆ†æï¼šçœ‹ä¸æ‡‚

![image-20210719161353274](assets/image-20210719161353274.png)

![image-20210719161653048](assets/image-20210719161653048.png)

#### 467. ç¯ç»•å­—ç¬¦ä¸²ä¸­å”¯ä¸€çš„å­å­—ç¬¦ä¸²



æŠŠå­—ç¬¦ä¸² s çœ‹ä½œæ˜¯â€œabcdefghijklmnopqrstuvwxyzâ€çš„æ— é™ç¯ç»•å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥ s çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š"...zabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcd....". 

ç°åœ¨æˆ‘ä»¬æœ‰äº†å¦ä¸€ä¸ªå­—ç¬¦ä¸² p ã€‚ä½ éœ€è¦çš„æ˜¯æ‰¾å‡º s ä¸­æœ‰å¤šå°‘ä¸ªå”¯ä¸€çš„ p çš„éç©ºå­ä¸²ï¼Œå°¤å…¶æ˜¯å½“ä½ çš„è¾“å…¥æ˜¯å­—ç¬¦ä¸² p ï¼Œä½ éœ€è¦è¾“å‡ºå­—ç¬¦ä¸² s ä¸­ p çš„ä¸åŒçš„éç©ºå­ä¸²çš„æ•°ç›®ã€‚ 

æ³¨æ„: p ä»…ç”±å°å†™çš„è‹±æ–‡å­—æ¯ç»„æˆï¼Œp çš„å¤§å°å¯èƒ½è¶…è¿‡ 10000ã€‚



ç¤ºä¾‹ 1:

è¾“å…¥: "a"
è¾“å‡º: 1
è§£é‡Š: å­—ç¬¦ä¸² S ä¸­åªæœ‰ä¸€ä¸ª"a"å­å­—ç¬¦ã€‚


ç¤ºä¾‹ 2:

è¾“å…¥: "cac"
è¾“å‡º: 2
è§£é‡Š: å­—ç¬¦ä¸² S ä¸­çš„å­—ç¬¦ä¸²â€œcacâ€åªæœ‰ä¸¤ä¸ªå­ä¸²â€œaâ€ã€â€œcâ€ã€‚


ç¤ºä¾‹ 3:

è¾“å…¥: "zab"
è¾“å‡º: 6
è§£é‡Š: åœ¨å­—ç¬¦ä¸² S ä¸­æœ‰å…­ä¸ªå­ä¸²â€œzâ€ã€â€œaâ€ã€â€œbâ€ã€â€œzaâ€ã€â€œabâ€ã€â€œzabâ€ã€‚

---

* æ¯é¢˜ 2-ç›¸é‚»å·®å€¼ä¸º 1 è¿ç»­å­æ•°ç»„ä¸ªæ•°

ä»”ç»†çœ‹ä¸‹é¢˜ç›®å‘ç°ï¼Œè¿™ä¸å°±æ˜¯æ¯é¢˜ 2 çš„å˜ç§ä¹ˆï¼Ÿ

å›æƒ³preå’Œresçš„å®šä¹‰ï¼Œpreè¡¨ç¤ºä»¥å½“å‰ä¸‹æ ‡iç»“å°¾çš„è¿ç»­é€’å¢å­æ•°ç»„çš„ä¸ªæ•°ï¼Œresè¡¨ç¤º[0,i]èŒƒå›´å†…çš„è¿ç»­é€’å¢å­æ•°ç»„ä¸ªæ•°ã€‚æœ¬é¢˜çš„ç›®çš„æ˜¯è¦æ‰¾å­—ç¬¦ä¸² s ä¸­ p çš„ä¸åŒçš„éç©ºå­ä¸²çš„æ•°ç›®ï¼Œå› æ­¤ï¼Œå¯¹åŒä¸€ä¸ªå­—ç¬¦ï¼Œé€šè¿‡å­—å…¸å˜é‡dp[ch]è®°å½•è¯¥å­—ç¬¦å¯¹åº”çš„æœ€å¤§preå°±åŒ…å«äº†æ‰€æœ‰çš„preæƒ…å†µã€‚æœ€åå°†æ‰€æœ‰dpå€¼åŠ èµ·æ¥å°±æ˜¯resã€‚

ä»¥`abzab`ä¸ºä¾‹ï¼š

å­—ç¬¦ä¸²ï¼š a b z a b

pre:     1 2 1 2 3

dp[ch]:  dp['a']=2;dp['b']=3;dp['z']=1

c++ç‰ˆæœ¬ï¼š

```java
public class Solution {
    public int findSubstringInWraproundString(String p) {
        // count[i] is the maximum unique substring end with ith letter.
        // 0 - 'a', 1 - 'b', ..., 25 - 'z'.
        int[] len_mapper = new int[26];

        // store longest contiguous substring ends at current position.
        int w = 1;

        for (int i = 0; i < p.length(); i++) {
            if (i > 0 && (p.charAt(i) - p.charAt(i - 1) == 1 || (p.charAt(i - 1) - p.charAt(i) == 25))) {
                w++; 
            } else {
                w = 1;
            }

            int index = p.charAt(i) - 'a';
            len_mapper[index] = Math.max(len_mapper[index], w);  
        }

        // Sum to get result
        int sum = 0;
        for (int i = 0; i < 26; i++) {
            sum += len_mapper[i];
        }
        return sum;
    }
}
```

---

ä¸‹é¢æ˜¯åŠ›æ‰£åŠ åŠ çš„è§£é‡Šï¼Œæˆ‘è§‰å¾—æœ‰ç‚¹ç»•ã€‚

è¯ä¸å¤šè¯´ï¼Œ ç›´æ¥ä¸Šä»£ç ï¼Œçœ‹çœ‹æœ‰å¤šåƒã€‚

> ä¸ºäº†å‡å°‘åˆ¤æ–­ï¼Œ æˆ‘è¿™é‡Œç”¨äº†ä¸€ä¸ªé»‘ç§‘æŠ€ï¼Œ p å‰é¢åŠ äº†ä¸ª `^`ã€‚

```python
class Solution:
    def findSubstringInWraproundString(self, p: str) -> int:
        p = '^' + p
        w = 1
        ans = 0
        for i in range(1,len(p)):
            if ord(p[i])-ord(p[i-1]) == 1 or ord(p[i])-ord(p[i-1]) == -25:
                w += 1
            else:
                w = 1
            ans += w
        return ans
```

å¦‚ä¸Šä»£ç æ˜¯æœ‰é—®é¢˜ã€‚ æ¯”å¦‚ `cac`ä¼šè¢«è®¡ç®—ä¸º 3ï¼Œå®é™…ä¸Šåº”è¯¥æ˜¯ 2ã€‚æ ¹æœ¬åŸå› åœ¨äº c è¢«é”™è¯¯åœ°è®¡ç®—äº†ä¸¤æ¬¡ã€‚å› æ­¤ä¸€ä¸ªç®€å•çš„æ€è·¯å°±æ˜¯ç”¨ set è®°å½•ä¸€ä¸‹è®¿é—®è¿‡çš„å­å­—ç¬¦ä¸²å³å¯ã€‚æ¯”å¦‚ï¼š

```
{    c,    abc,    ab,    abcd}
```

*è€Œç”±äº set ä¸­çš„å…ƒç´ ä¸€å®šæ˜¯è¿ç»­çš„ï¼Œå› æ­¤ä¸Šé¢çš„æ•°æ®ä¹Ÿå¯ä»¥ç”¨ hashmap å­˜ï¼š*

```
{    c: 3    d: 4    b: 1}
```

å«ä¹‰æ˜¯ï¼š

- **ä»¥ b ç»“å°¾**çš„å­ä¸²æœ€å¤§é•¿åº¦ä¸º 1ï¼Œä¹Ÿå°±æ˜¯ bã€‚
- ä»¥ c ç»“å°¾çš„å­ä¸²æœ€å¤§é•¿åº¦ä¸º 3ï¼Œä¹Ÿå°±æ˜¯ abcã€‚
- ä»¥ d ç»“å°¾çš„å­ä¸²æœ€å¤§é•¿åº¦ä¸º 4ï¼Œä¹Ÿå°±æ˜¯ abcdã€‚

å®šä¹‰ä¸€ä¸ª len_mapperã€‚key æ˜¯ å­—æ¯ï¼Œ value æ˜¯ é•¿åº¦ã€‚ å«ä¹‰æ˜¯**ä»¥ key ç»“å°¾**çš„æœ€é•¿è¿ç»­å­ä¸²çš„é•¿åº¦ã€‚

æ¯”å¦‚: abcazabcï¼Œæ­¤æ—¶çš„ len_mapperï¼š

```
{    c: 4    b: 3    a: 2    z: 1}
```

*è¿™å°±å¾—åˆ°äº†å»é‡çš„ç›®çš„ã€‚è¿™ç§ç®—æ³•æ˜¯ä¸é‡ä¸æ¼çš„ï¼Œå› ä¸ºæœ€é•¿çš„è¿ç»­å­ä¸²ä¸€å®šæ˜¯åŒ…å«äº†æ¯”å®ƒçŸ­çš„è¿ç»­å­ä¸²*ï¼Œè¿™ä¸ªæ€æƒ³å’Œ [1297. å­ä¸²çš„æœ€å¤§å‡ºç°æ¬¡æ•°](https://github.com/azl397985856/leetcode/issues/266) å‰ªæçš„æ–¹æ³•æœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ã€‚

len_mapperæœ€åçš„å½¢å¼ï¼š

```
z a b c e g h i
1 2 3 4 1 1 2 3
```

---



#### 795. åŒºé—´å­æ•°ç»„ä¸ªæ•°

ç»™å®šä¸€ä¸ªå…ƒç´ éƒ½æ˜¯æ­£æ•´æ•°çš„æ•°ç»„ A ï¼Œæ­£æ•´æ•° L  ä»¥åŠ  R (L <= R)ã€‚

æ±‚è¿ç»­ã€éç©ºä¸”å…¶ä¸­æœ€å¤§å…ƒç´ æ»¡è¶³å¤§äºç­‰äº L  å°äºç­‰äº R çš„å­æ•°ç»„ä¸ªæ•°ã€‚

ä¾‹å¦‚ :
è¾“å…¥:
A = [2, 1, 4, 3]
L = 2
R = 3
è¾“å‡º: 3
è§£é‡Š: æ»¡è¶³æ¡ä»¶çš„å­æ•°ç»„: [2], [2, 1], [3].
æ³¨æ„:

L, R  å’Œ  A[i] éƒ½æ˜¯æ•´æ•°ï¼ŒèŒƒå›´åœ¨  [0, 10^9]ã€‚
æ•°ç»„  A  çš„é•¿åº¦èŒƒå›´åœ¨[1, 50000]ã€‚

---

* æ¯é¢˜ 5-æœ€å¤§å€¼ä»‹äº[k1,k2]çš„è¿ç»­å­æ•°ç»„ä¸ªæ•°

ç”±**æ¯é¢˜ 5**ï¼Œæˆ‘ä»¬çŸ¥é“ betweenK å¯ä»¥ç›´æ¥åˆ©ç”¨ atMostKï¼Œå³ atMostK(k1) - atMostK(k2 - 1)ï¼Œå…¶ä¸­ k1 > k2ã€‚

```python
class Solution:
    def numSubarrayBoundedMax(self, A: list[int], L: int, R: int) -> int:
        def notGreater(R):
            ans = cnt = 0
            for a in A:
                if a <= R: cnt += 1
                else: cnt = 0
                ans += cnt
            return  ans

        return notGreater(R) - notGreater(L - 1)
```

ä¸èƒ½å†™æˆä¸‹é¢è¿™æ ·ï¼š

```java
class Solution {
    public int numSubarrayBoundedMax(int[] nums, int left, int right) {
        int length = nums.length;
        int pre = 0;// ä»¥iä¸‹æ ‡ç»“å°¾çš„ç¬¦åˆæ¡ä»¶çš„æ•°ç»„ä¸ªæ•°
        int res = 0;
        int maxNum = nums[0];// ç»Ÿè®¡æ•°ç»„å…ƒç´ æœ€å¤§å€¼
        for (int i = 0; i < length; i++) {
            maxNum = Math.max(maxNum, nums[i]);
            // ä¸èƒ½è¿™æ ·åˆ¤æ–­ï¼Œå½“æœ€å¤§å€¼ä¸åœ¨å½“å‰çª—å£æ—¶ï¼Œåº”è¯¥åªç»Ÿè®¡å½“å‰çª—å£æœ€å¤§å€¼ï¼Œè€Œä¸æ˜¯å†å²æœ€å¤§å€¼
            // [2, 1, 4, 3],å¦åˆ™å®ƒçš„ç­”æ¡ˆå°±æ˜¯[2], [2, 1],[1], [3].
            if (maxNum >= left && maxNum <= right) {
                pre += 1;
            } else {
                pre = 0;
            }
            res += pre;
        }
        return res;
    }
}
```





#### 992.K ä¸ªä¸åŒæ•´æ•°çš„å­æ•°ç»„

ç»™å®šä¸€ä¸ªæ­£æ•´æ•°æ•°ç»„ Aï¼Œå¦‚æœ A çš„æŸä¸ªå­æ•°ç»„ä¸­ä¸åŒæ•´æ•°çš„ä¸ªæ•°æ°å¥½ä¸º Kï¼Œåˆ™ç§° A çš„è¿™ä¸ªè¿ç»­ã€ä¸ä¸€å®šç‹¬ç«‹çš„å­æ•°ç»„ä¸ºå¥½å­æ•°ç»„ã€‚

ï¼ˆä¾‹å¦‚ï¼Œ[1,2,3,1,2] ä¸­æœ‰ 3 ä¸ªä¸åŒçš„æ•´æ•°ï¼š1ï¼Œ2ï¼Œä»¥åŠ 3ã€‚ï¼‰

è¿”å› A ä¸­å¥½å­æ•°ç»„çš„æ•°ç›®ã€‚



ç¤ºä¾‹ 1ï¼š

è¾“å…¥ï¼šA = [1,2,1,2,3], K = 2
è¾“å‡ºï¼š7
è§£é‡Šï¼šæ°å¥½ç”± 2 ä¸ªä¸åŒæ•´æ•°ç»„æˆçš„å­æ•°ç»„ï¼š[1,2], [2,1], [1,2], [2,3], [1,2,1], [2,1,2], [1,2,1,2].
ç¤ºä¾‹ 2ï¼š

è¾“å…¥ï¼šA = [1,2,1,3,4], K = 3
è¾“å‡ºï¼š3
è§£é‡Šï¼šæ°å¥½ç”± 3 ä¸ªä¸åŒæ•´æ•°ç»„æˆçš„å­æ•°ç»„ï¼š[1,2,1,3], [2,1,3], [1,3,4].


æç¤ºï¼š

1 <= A.length <= 20000
1 <= A[i] <= A.length
1 <= K <= A.length



---



**æ»‘åŠ¨çª—å£+æ¯é¢˜ 3-ä¸å¤§äº k çš„è¿ç»­å­æ•°ç»„ä¸ªæ•°**

å’Œ[159.è‡³å¤šåŒ…å«ä¸¤ä¸ªä¸åŒå­—ç¬¦çš„æœ€é•¿å­ä¸²](https://leetcode-cn.com/problems/longest-substring-with-at-most-two-distinct-characters/)æœ‰ç‚¹ç±»ä¼¼ï¼Œåªä¸è¿‡æœ¬é¢˜éœ€è¦æ±‚å­æ•°ç»„ä¸ªæ•°ï¼Œå› æ­¤ä½¿ç”¨æ»‘åŠ¨çª—å£+æ¯é¢˜ 3-ä¸å¤§äº k çš„è¿ç»­å­æ•°ç»„ä¸ªæ•°çš„æ–¹æ³•æ¥è§£å†³ï¼Œå¦å¤–å°†æœ¬é¢˜è½¬æ¢ä¸ºæ±‚ä¸åŒæ•´æ•°çš„ä¸ªæ•°â‰¤Kï¼Œå› ä¸ºéœ€è¦çª—å£å¢å¤§çš„è¿‡ç¨‹ä¸­åˆ©ç”¨å‰ç¼€å’Œæ€æƒ³è®¡ç®—å­æ•°ç»„ä¸ªæ•°ã€‚å¦‚æœç›´æ¥ä½¿ç”¨å­æ•°ç»„ä¸­ä¸åŒæ•´æ•°çš„ä¸ªæ•°æ°å¥½ä¸º Kçš„é¢˜æ„ç›´æ¥ä½¿ç”¨æ»‘åŠ¨çª—å£çš„è¯ä¼šå‘ç°éå¸¸éš¾åšå‡ºæ¥ï¼Œå› ä¸ºæœ¬é¢˜æ±‚çš„æ˜¯å­æ•°ç»„ä¸ªæ•°è€Œä¸æ˜¯æœ€çŸ­å­æ•°ç»„é•¿åº¦ã€‚

å¦å¤–ï¼Œæ³¨æ„åˆ°é¢˜ç›®æ•°ç»„å¤§å°å’ŒKçš„èŒƒå›´ï¼ŒçŒœæƒ³å’Œ[159.è‡³å¤šåŒ…å«ä¸¤ä¸ªä¸åŒå­—ç¬¦çš„æœ€é•¿å­ä¸²](https://leetcode-cn.com/problems/longest-substring-with-at-most-two-distinct-characters/)ä¸€æ ·ï¼Œåˆ é™¤çª—å£æ•°ç»„æ—¶ä½¿ç”¨`window.erase(ch)`è€Œä¸æ˜¯ä½¿ç”¨valid,ä½†æ˜¯åœ¨leetCodeæäº¤æ—¶å‘ç°ä¸¤ç§åšæ³•ç”¨æ—¶ä¸€æ ·ï¼Œæ‰€ä»¥å“ªç§åšæ³•éƒ½å¯ä»¥ã€‚

**æ»‘åŠ¨çª—å£ç®—æ³•çš„æ€è·¯æ˜¯è¿™æ ·**ï¼š

1.çª—å£åˆå§‹åŒ– `left = right = 0`ï¼Œçª—å£ä¸º[left,right];

2.å…ˆä½¿ç”¨rightæŒ‡é’ˆæ‰©å¤§çª—å£ï¼›

3.å½“çª—å£ä¸­çš„å­—ç¬¦ä¸²ä¸ç¬¦åˆè¦æ±‚ï¼ˆä¸åŒæ•´æ•°çš„ä¸ªæ•°ï¼ Kï¼‰æ—¶ï¼Œä½¿ç”¨leftæŒ‡é’ˆç¼©å°çª—å£ï¼Œç›´åˆ°çª—å£ä¸­çš„å­—ç¬¦ä¸²ç¬¦åˆè¦æ±‚ï¼ˆä¸åŒæ•´æ•°çš„ä¸ªæ•°â‰¤Kï¼‰ï¼Œç¼©å°çª—å£å®Œæˆåè®¡ç®—resã€‚

4.é‡å¤ç¬¬ 2 å’Œç¬¬ 3 æ­¥ï¼Œç›´åˆ° right åˆ°è¾¾æ•°ç»„çš„å°½å¤´ã€‚

4.é‡å¤ç¬¬ 2 å’Œç¬¬ 3 æ­¥ï¼Œç›´åˆ° `right` åˆ°è¾¾å­—ç¬¦ä¸² `S` çš„å°½å¤´ã€‚

```java
class Solution {
public:
    int subarraysWithKDistinct(vector<int> &nums, int k)
    {
        return atMost(nums, k) - atMost(nums, k - 1);
    }
    int atMost(vector<int> &nums, int k)  //æœ€å¤šåŒ…å«kä¸ªä¸åŒæ•°å­—çš„æœ€é•¿å­æ•°ç»„ä¸ªæ•°
    {
        unordered_map<int, int> window;
        int ret = 0;
        int valid = 0;  //è®°å½•çª—å£ä¸­æœ‰å‡ ä¸ªä¸åŒçš„æ•°å­—
        for (int left = 0, right = 0; right < nums.size(); right++) {
            window[nums[right]]++;
            if (window[nums[right]] == 1) {
                valid++;
            }
            // åˆ¤æ–­å·¦ä¾§çª—å£æ˜¯å¦è¦æ”¶ç¼©
            while (valid > k) {
                window[nums[left]]--;
                if (window[nums[left]] == 0) {
                    valid--;
                }
                left++;
            }
            /*
            lenè¡¨ç¤ºä»¥rightä¸‹æ ‡ä¸ºç»“å°¾çš„å­æ•°ç»„ä¸ªæ•°ï¼Œç›¸å½“äºpre
            righté€æ¸æ‰©å¢ç›´åˆ°æœ€å¤§ç­‰äºrightMaxæ—¶ï¼Œretä¸æ–­ç´¯åŠ right - left + 1ï¼Œç´¯åŠ åˆ°æœ€åå°±è¡¨ç¤º[left,right]~[left,rightMax]åŒºé—´(æœ€å¤šåŒ…å«kä¸ªä¸åŒæ•°å­—)çš„å­æ•°ç»„ã€‚
            */
            int len = right - left + 1;
            ret += len;
        }
        return ret;
    }
};
```



#### [560.å’Œä¸ºKçš„å­æ•°ç»„](https://leetcode-cn.com/problems/subarray-sum-equals-k)



![img](assets/cb19e8180ff444ac0a65442dbd64dd2ccc4aa76c-1622430823508.png)

---



* **æ¯é¢˜0-å‰ç¼€å’Œ + å“ˆå¸Œ**

æˆ‘ä»¬æƒ³æ±‚æœ‰å¤šå°‘ä¸ªå­æ•°ç»„çš„å’Œä¸º kï¼Œå€ŸåŠ©å‰ç¼€å’ŒæŠ€å·§å¾ˆå®¹æ˜“å†™å‡ºä¸€ä¸ªè§£æ³•ï¼š

```c
int subarraySum(int[] nums, int k) {
    int n = nums.length;
    // æ„é€ å‰ç¼€å’Œ
    int[] sum = new int[n + 1];
    for (int i = 0; i < n; i++)
        sum[i] = sum[i-1] + nums[i];

    int ans = 0;
    // ç©·ä¸¾æ‰€æœ‰å­æ•°ç»„
    for (int i = 1; i <= n; i++)
        for (int j = 0; j < i; j++)
            // sum of nums[j..i-1]
            if (sum[i] - sum[j] == k)
                ans++;

    return ans;
}
```

è¿™ä¸ªè§£æ³•çš„æ—¶é—´å¤æ‚åº¦ `O(N^2)` ç©ºé—´å¤æ‚åº¦ `O(N)`ï¼Œå¹¶ä¸æ˜¯æœ€ä¼˜çš„è§£æ³•ã€‚ä¸è¿‡é€šè¿‡è¿™ä¸ªè§£æ³•ç†è§£äº†å‰ç¼€å’Œæ•°ç»„çš„å·¥ä½œåŸç†ä¹‹åï¼Œå¯ä»¥ä½¿ç”¨ä¸€äº›å·§å¦™çš„åŠæ³•æŠŠæ—¶é—´å¤æ‚åº¦è¿›ä¸€æ­¥é™ä½ã€‚

å‰é¢çš„è§£æ³•æœ‰åµŒå¥—çš„ for å¾ªç¯ï¼š



```
for (int i = 1; i <= n; i++)
    for (int j = 0; j < i; j++)
        if (sum[i] - sum[j] == k)
            ans++;
```

ç¬¬äºŒå±‚ for å¾ªç¯åœ¨å¹²å˜›å‘¢ï¼Ÿç¿»è¯‘ä¸€ä¸‹å°±æ˜¯ï¼Œ**åœ¨è®¡ç®—ï¼Œæœ‰å‡ ä¸ª** **`j`** **èƒ½å¤Ÿä½¿å¾—** **`sum[i]`** **å’Œ** **`sum[j]`** **çš„å·®ä¸º kã€‚**æ¯æ‰¾åˆ°ä¸€ä¸ªè¿™æ ·çš„ `j`ï¼Œå°±æŠŠç»“æœåŠ ä¸€ã€‚

æˆ‘ä»¬å¯ä»¥æŠŠ if è¯­å¥é‡Œçš„æ¡ä»¶åˆ¤æ–­ç§»é¡¹ï¼Œè¿™æ ·å†™ï¼š

```
if (sum[j] == sum[i] - k)    ans++;
```

ä¼˜åŒ–çš„æ€è·¯æ˜¯ï¼š**æˆ‘ç›´æ¥è®°å½•ä¸‹æœ‰å‡ ä¸ª** **`sum[j]`** **å’Œ** **`sum[i] - k`** **ç›¸ç­‰ï¼Œç›´æ¥æ›´æ–°ç»“æœï¼Œå°±é¿å…äº†å†…å±‚çš„ for å¾ªç¯**ã€‚æˆ‘ä»¬å¯ä»¥ç”¨å“ˆå¸Œè¡¨ï¼Œåœ¨è®°å½•å‰ç¼€å’Œçš„åŒæ—¶è®°å½•è¯¥å‰ç¼€å’Œå‡ºç°çš„æ¬¡æ•°ã€‚

```java
int subarraySum(int[] nums, int k) {
    int n = nums.length;
    // mapï¼šå‰ç¼€å’Œ -> è¯¥å‰ç¼€å’Œå‡ºç°çš„æ¬¡æ•°
    HashMap<Integer, Integer> preSum = new HashMap<>();
    // base case
    preSum.put(0, 1);

    int ans = 0, sum0_i = 0;
    for (int i = 0; i < n; i++) {
        sum0_i += nums[i];
        // è¿™æ˜¯æˆ‘ä»¬æƒ³æ‰¾çš„å‰ç¼€å’Œ nums[0..j]
        int sum0_j = sum0_i - k;
        // å¦‚æœå‰é¢æœ‰è¿™ä¸ªå‰ç¼€å’Œï¼Œåˆ™ç›´æ¥æ›´æ–°ç­”æ¡ˆ
        if (preSum.containsKey(sum0_j))
            ans += preSum.get(sum0_j);
        // æŠŠå‰ç¼€å’Œ nums[0..i] åŠ å…¥å¹¶è®°å½•å‡ºç°æ¬¡æ•°
        preSum.put(sum0_i, preSum.getOrDefault(sum0_i, 0) + 1);
    }
    return ans;
}
```

æ—¶é—´å¤æ‚åº¦é™åˆ°äº† `O(N)`ã€‚

* ä¸€å®šè¦æ³¨æ„ï¼šå› ä¸ºæ˜¯åœ¨[0,i-1]èŒƒå›´å†…æŸ¥æ‰¾æ˜¯å¦æœ‰æ±‚çš„å€¼ï¼Œå› æ­¤å¯¹æ•°æ®`sum0_i-k`çš„æŸ¥è¯¢åœ¨å‰ï¼Œå¯¹å‰ç¼€å’Œ`sum0_i`çš„æ’å…¥åœ¨åã€‚

####  [437. è·¯å¾„æ€»å’Œ III](https://leetcode-cn.com/problems/path-sum-iii/solution/qian-zhui-he-di-gui-hui-su-by-shi-huo-de-xia-tian/)

![image-20210720162455229](assets/image-20210720162455229.png)

![image-20210720162519616](assets/image-20210720162519616.png)

---

è§£æ³•ä¸€ã€å›æº¯

1.å‡½æ•°å®šä¹‰ã€å‚æ•°åŠè¿”å›å€¼

`int pathSum(TreeNode* root, int targetSum)` ä»¥rootä¸ºå¤´æ•´æ£µæ ‘çš„è·¯å¾„æ€»å’Œ

2.é€’å½’ç»ˆæ­¢æ¡ä»¶

rootä¸ºç©º

3.å•å±‚é€»è¾‘

rootä½œä¸ºè·¯å¾„å‡ºå‘ç‚¹çš„è·¯å¾„æ€»å’Œ+ä»¥root.leftä¸ºå¤´çš„æ ‘çš„è·¯å¾„æ€»å’Œ+ä»¥root.rightä¸ºå¤´çš„æ ‘çš„è·¯å¾„æ€»å’Œ;

å®šä¹‰`int help(TreeNode* root, int targetSum)`è®¡ç®—rootä½œä¸ºè·¯å¾„å‡ºå‘ç‚¹çš„è·¯å¾„æ€»å’Œ

1.å‡½æ•°å®šä¹‰ã€å‚æ•°åŠè¿”å›å€¼

`int help(TreeNode* root, int targetSum)` rootä½œä¸ºè·¯å¾„å‡ºå‘ç‚¹çš„è·¯å¾„æ€»å’Œ

2.é€’å½’ç»ˆæ­¢æ¡ä»¶

rootä¸ºç©º,éå†å®Œæ•´ä¸ªäºŒå‰æ ‘

3.å•å±‚é€»è¾‘

...

åˆ™ä»£ç ä¸ºï¼š

```c
class Solution {
    // ä»¥rootä¸ºå¤´æ•´æ£µæ ‘çš„è·¯å¾„æ€»å’Œ
    int pathSum(TreeNode root, int targetSum) {
        if (root == null) {
            return 0;
        }
        // the number of the paths starting from self
        int self = help(root, targetSum);
        // we don't know the answer, so we just pass it down
        int lpath = pathSum(root.left, targetSum);
        // we don't know the answer, so we just pass it down
        int rpath = pathSum(root.right, targetSum);
        return self + lpath + rpath;
    }


    // rootä½œä¸ºè·¯å¾„å‡ºå‘ç‚¹çš„è·¯å¾„æ€»å’Œ
    int help(TreeNode root, int target) {
        if (root == null) {
            return 0;
        }
        int left = help(root.left, target - root.val);
        int right = help(root.right, target - root.val);
        return left + right + ((root.val == target) ? 1 : 0);
    }
}

```

æ—¶é—´å¤æ‚åº¦ä»‹äºO(nlogn) å’Œ O(n^2)

ä½†æ˜¯è¿˜æœ‰ä¸€ç§ç©ºé—´å¤æ‚åº¦æ›´åŠ ä¼˜ç§€çš„ç®—æ³•ï¼Œåˆ©ç”¨ hashmap æ¥é¿å…é‡å¤è®¡ç®—ï¼Œæ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦éƒ½æ˜¯ O(n)ã€‚

è§£æ³•äºŒï¼š

- 560.å’Œä¸ºKçš„å­æ•°ç»„ äºŒå‰æ ‘ç‰ˆ(å‰ç¼€å’Œ) + å“ˆå¸Œ

å‰ç¼€å’Œå®šä¹‰:

ä¸€ä¸ªèŠ‚ç‚¹çš„å‰ç¼€å’Œå°±æ˜¯è¯¥èŠ‚ç‚¹åˆ°æ ¹ä¹‹é—´çš„è·¯å¾„å’Œã€‚

æ‹¿ä¸‹å›¾è§£é‡Šï¼š
èŠ‚ç‚¹4çš„å‰ç¼€å’Œä¸ºï¼š1 + 2 + 4 = 7
èŠ‚ç‚¹8çš„å‰ç¼€å’Œï¼š1 + 2 + 4 + 8 = 15
èŠ‚ç‚¹9çš„å‰ç¼€å’Œï¼š1 + 2 + 5 + 9 = 17

```python
      1
     /  \
    2    3
   / \    \
  4   5    6
 / \   \
7   8   9
```
é¢˜ç›®è¦æ±‚çš„æ˜¯æ‰¾å‡ºè·¯å¾„å’Œç­‰äºç»™å®šæ•°å€¼çš„è·¯å¾„æ€»æ•°, è€Œ:ä¸¤èŠ‚ç‚¹é—´çš„è·¯å¾„å’Œ = ä¸¤èŠ‚ç‚¹çš„å‰ç¼€å’Œä¹‹å·®

ç†è§£äº†è¿™ä¸ªä¹‹åï¼Œ**é—®é¢˜å°±å¾—ä»¥ç®€åŒ–ï¼š**

**æˆ‘ä»¬åªç”¨éå†æ•´é¢—æ ‘ä¸€æ¬¡ï¼Œè®°å½•æ¯ä¸ªèŠ‚ç‚¹çš„å‰ç¼€å’Œï¼Œå¹¶æŸ¥è¯¢è¯¥èŠ‚ç‚¹çš„ç¥–å…ˆèŠ‚ç‚¹ä¸­ç¬¦åˆæ¡ä»¶çš„ä¸ªæ•°ï¼Œå°†è¿™ä¸ªæ•°é‡åŠ åˆ°æœ€ç»ˆç»“æœä¸Šã€‚æ€è€ƒï¼š**

* HashMapå­˜çš„æ˜¯ä»€ä¹ˆ
  HashMapçš„keyæ˜¯å‰ç¼€å’Œï¼Œ valueæ˜¯è¯¥å‰ç¼€å’Œçš„èŠ‚ç‚¹æ•°é‡ï¼Œè®°å½•æ•°é‡æ˜¯å› ä¸ºæœ‰å‡ºç°å¤æ•°è·¯å¾„çš„å¯èƒ½ã€‚

æ‹¿å›¾è¯´æ˜ï¼š

ä¸‹å›¾æ ‘ä¸­ï¼Œå‰ç¼€å’Œä¸º1çš„èŠ‚ç‚¹æœ‰ä¸¤ä¸ª: 1, 0

æ‰€ä»¥è·¯å¾„å’Œä¸º2çš„è·¯å¾„æ•°å°±æœ‰ä¸¤æ¡: 0 --> 2, 2
```python
      1
     / 
    0
   /
  2
```
* æ¢å¤çŠ¶æ€çš„æ„ä¹‰
  ç”±äºé¢˜ç›®è¦æ±‚ï¼šè·¯å¾„æ–¹å‘å¿…é¡»æ˜¯å‘ä¸‹çš„ï¼ˆåªèƒ½ä»çˆ¶èŠ‚ç‚¹åˆ°å­èŠ‚ç‚¹ï¼‰

å½“æˆ‘ä»¬è®¨è®ºä¸¤ä¸ªèŠ‚ç‚¹çš„å‰ç¼€å’Œå·®å€¼æ—¶ï¼Œæœ‰ä¸€ä¸ªå‰æï¼š

ä¸€ä¸ªèŠ‚ç‚¹å¿…é¡»æ˜¯å¦ä¸€ä¸ªèŠ‚ç‚¹çš„ç¥–å…ˆèŠ‚ç‚¹

æ¢å¥è¯è¯´ï¼Œå½“æˆ‘ä»¬æŠŠä¸€ä¸ªèŠ‚ç‚¹çš„å‰ç¼€å’Œä¿¡æ¯æ›´æ–°åˆ°mapé‡Œæ—¶ï¼Œå®ƒåº”å½“åªå¯¹å…¶å­èŠ‚ç‚¹ä»¬æœ‰æ•ˆã€‚

å·¦å³å­æ ‘éå†å®Œæˆä¹‹åï¼Œå›åˆ°å½“å‰å±‚ï¼Œéœ€è¦æŠŠå½“å‰èŠ‚ç‚¹æ·»åŠ çš„å‰ç¼€å’Œå»é™¤ã€‚é¿å…å›æº¯ä¹‹åå½±å“ä¸Šä¸€å±‚ã€‚

```c
class Solution {
    int res = 0;

    int pathSum(TreeNode root, int targetSum) {
        if (root == null) {
            return 0;
        }
        HashMap<Integer, Integer> hashMap = new HashMap<Integer, Integer>();
        // base case
        hashMap.put(0, 1);
        backtrcking(root, targetSum, hashMap, 0);
        return res;
    }

    // å‡½æ•°æ„ä¹‰ï¼šå…ˆåºéå†äºŒå‰æ ‘çš„åŒæ—¶æ„å»ºå‰ç¼€å’ŒMap
    //å‡½æ•°å‚æ•°-preï¼šrootçˆ¶èŠ‚ç‚¹çš„å‰ç¼€å’Œ
    void backtrcking(TreeNode root, int targetSum, Map<Integer, Integer> map, int pre) {
        if (root == null) {
            return;
        }
        pre += root.val;
        // ä¸€å®šè¦æ³¨æ„ï¼šå› ä¸ºæ˜¯åœ¨[0,i-1]èŒƒå›´å†…æŸ¥æ‰¾æ˜¯å¦æœ‰æ±‚çš„å€¼ï¼Œå› æ­¤å¯¹æ•°æ®`sum0_i-k`çš„æŸ¥è¯¢åœ¨å‰ï¼Œå¯¹å‰ç¼€å’Œ`sum0_i`çš„æ’å…¥åœ¨åã€‚
        int find = pre-targetSum;
        if (map.containsKey(find)) {
            res += map.get(find);// ä»¥rootä¸ºè·¯å¾„ç»“å°¾çš„è·¯å¾„ä¹‹å’Œ
        }
        // æŸ¥è¯¢åå†æ’å…¥
        map.put(pre, map.getOrDefault(pre, 0) + 1);
        backtrcking(root.left, targetSum, map, pre);
        backtrcking(root.right, targetSum, map, pre);
        
        map.put(pre, map.get(pre) - 1);
        pre -= root.val;
    }

}
```

# å·®åˆ†æ•°ç»„

**å‰ç¼€å’Œä¸»è¦é€‚ç”¨çš„åœºæ™¯æ˜¯åŸå§‹æ•°ç»„ä¸ä¼šè¢«ä¿®æ”¹çš„æƒ…å†µä¸‹ï¼Œé¢‘ç¹æŸ¥è¯¢æŸä¸ªåŒºé—´çš„ç´¯åŠ å’Œ**ã€‚

`preSum[i] = preSum[i - 1] + nums[i];`

ã€Œå·®åˆ†æ•°ç»„ã€å’Œå‰ç¼€å’Œæ€æƒ³éå¸¸åƒï¼Œ**å·®åˆ†æ•°ç»„çš„ä¸»è¦é€‚ç”¨åœºæ™¯æ˜¯é¢‘ç¹å¯¹åŸå§‹æ•°ç»„çš„æŸä¸ªåŒºé—´çš„å…ƒç´ è¿›è¡Œå¢å‡**ã€‚

`diff[i] = nums[i] - nums[i - 1];`

å‰ç¼€å’Œä¸å·®åˆ†æ•°ç»„äº’ä¸ºé€†è¿ç®—ã€‚å¦‚ä½•ç†è§£å‘¢ï¼Ÿè¿™é‡Œçš„åŸå› åœ¨äºä½ å¯¹ nums çš„å·®åˆ†æ•°ç»„ diff æ±‚å‰ç¼€å’Œå°±æ˜¯æ•°ç»„ numsã€‚å‰ç¼€å’Œå¯¹äºæ±‚åŒºé—´å’Œæœ‰é‡å¤§æ„ä¹‰ã€‚è€Œå·®åˆ†æ•°ç»„é€šå¸¸ç”¨äº**å…ˆå¯¹æ•°ç»„çš„è‹¥å¹²åŒºé—´æ‰§è¡Œè‹¥å¹²æ¬¡å¢åŠ æˆ–è€…å‡å°‘æ“ä½œ**ã€‚

**å·®åˆ†æ•°ç»„çš„ä¸»è¦é€‚ç”¨åœºæ™¯æ˜¯é¢‘ç¹å¯¹åŸå§‹æ•°ç»„çš„æŸä¸ªåŒºé—´çš„å…ƒç´ è¿›è¡Œå¢å‡**ã€‚

æ¯”å¦‚è¯´ï¼Œæˆ‘ç»™ä½ è¾“å…¥ä¸€ä¸ªæ•°ç»„`nums`ï¼Œç„¶ååˆè¦æ±‚ç»™åŒºé—´`nums[2..6]`å…¨éƒ¨åŠ  1ï¼Œå†ç»™`nums[3..9]`å…¨éƒ¨å‡ 3ï¼Œå†ç»™`nums[0..4]`å…¨éƒ¨åŠ  2ï¼Œå†ç»™â€¦

ä¸€é€šæ“ä½œçŒ›å¦‚è™ï¼Œç„¶åé—®ä½ ï¼Œæœ€å`nums`æ•°ç»„çš„å€¼æ˜¯ä»€ä¹ˆï¼Ÿ

å¸¸è§„çš„æ€è·¯å¾ˆå®¹æ˜“ï¼Œä½ è®©æˆ‘ç»™åŒºé—´`nums[i..j]`åŠ ä¸Š`val`ï¼Œé‚£æˆ‘å°±ä¸€ä¸ª for å¾ªç¯ç»™å®ƒä»¬éƒ½åŠ ä¸Šå‘—ï¼Œè¿˜èƒ½å’‹æ ·ï¼Ÿè¿™ç§æ€è·¯çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(N)ï¼Œç”±äºè¿™ä¸ªåœºæ™¯ä¸‹å¯¹`nums`çš„ä¿®æ”¹éå¸¸é¢‘ç¹ï¼Œæ‰€ä»¥æ•ˆç‡ä¼šå¾ˆä½ä¸‹ã€‚

è¿™é‡Œå°±éœ€è¦å·®åˆ†æ•°ç»„çš„æŠ€å·§ï¼Œæˆ‘ä»¬å…ˆå¯¹`nums`æ•°ç»„æ„é€ ä¸€ä¸ª`diff`å·®åˆ†æ•°ç»„ï¼Œ

```c
int[] diff = new int[nums.length];
// æ„é€ å·®åˆ†æ•°ç»„
diff[0] = nums[0];
for (int i = 1; i < nums.length; i++) {
    diff[i] = nums[i] - nums[i - 1];
}
```

<img src="assets/image-20210720200443238.png" alt="image-20210720200443238" style="zoom:50%;" />

é€šè¿‡è¿™ä¸ª`diff`å·®åˆ†æ•°ç»„æ˜¯å¯ä»¥åæ¨å‡ºåŸå§‹æ•°ç»„`nums`çš„ï¼Œä»£ç é€»è¾‘å¦‚ä¸‹ï¼š

```c
int[] res = new int[diff.length];
// æ ¹æ®å·®åˆ†æ•°ç»„æ„é€ ç»“æœæ•°ç»„
res[0] = diff[0];
for (int i = 1; i < diff.length; i++) {
    res[i] = res[i - 1] + diff[i];
}
```

**è¿™æ ·æ„é€ å·®åˆ†æ•°ç»„`diff`ï¼Œå°±å¯ä»¥å¿«é€Ÿè¿›è¡ŒåŒºé—´å¢å‡çš„æ“ä½œ**ï¼Œå¦‚æœä½ æƒ³å¯¹åŒºé—´`nums[i..j]`çš„å…ƒç´ å…¨éƒ¨åŠ  3ï¼Œé‚£ä¹ˆåªéœ€è¦è®©`diff[i] += 3`ï¼Œç„¶åå†è®©`diff[j+1] -= 3`å³å¯:

<img src="assets/image-20210720200134231.png" alt="image-20210720200134231" style="zoom:50%;" />

**åŸç†å¾ˆç®€å•ï¼Œå›æƒ³`diff`æ•°ç»„åæ¨`nums`æ•°ç»„çš„è¿‡ç¨‹ï¼Œ`diff[i] += 3`æ„å‘³ç€ç»™`nums[i..]`æ‰€æœ‰çš„å…ƒç´ éƒ½åŠ äº† 3ï¼Œç„¶å`diff[j+1] -= 3`åˆæ„å‘³ç€å¯¹äº`nums[j+1..]`æ‰€æœ‰å…ƒç´ å†å‡ 3ï¼Œé‚£ç»¼åˆèµ·æ¥ï¼Œæ˜¯ä¸æ˜¯å°±æ˜¯å¯¹`nums[i..j]`ä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½åŠ  3 äº†**ï¼Ÿ

åªè¦èŠ±è´¹ O(1) çš„æ—¶é—´ä¿®æ”¹`diff`æ•°ç»„ï¼Œå°±ç›¸å½“äºç»™`nums`çš„æ•´ä¸ªåŒºé—´åšäº†ä¿®æ”¹ã€‚å¤šæ¬¡ä¿®æ”¹`diff`ï¼Œç„¶åé€šè¿‡`diff`æ•°ç»„åæ¨ï¼Œå³å¯å¾—åˆ°`nums`ä¿®æ”¹åçš„ç»“æœã€‚

ç°åœ¨æˆ‘ä»¬æŠŠå·®åˆ†æ•°ç»„æŠ½è±¡æˆä¸€ä¸ªç±»ï¼ŒåŒ…å«`increment`æ–¹æ³•å’Œ`result`æ–¹æ³•ï¼š

```c
class Difference {
    // å·®åˆ†æ•°ç»„
    private int[] diff;

    public Difference(int[] nums) {
        assert nums.length > 0;
        diff = new int[nums.length];
        // æ„é€ å·®åˆ†æ•°ç»„
        diff[0] = nums[0];
        for (int i = 1; i < nums.length; i++) {
            diff[i] = nums[i] - nums[i - 1];
        }
    }

    /* ç»™é—­åŒºé—´ [i,j] å¢åŠ  valï¼ˆå¯ä»¥æ˜¯è´Ÿæ•°ï¼‰*/
    public void increment(int i, int j, int val) {
        diff[i] += val;
        if (j + 1 < diff.length) {
            diff[j + 1] -= val;
        }
    }

    public int[] result() {
        int[] res = new int[diff.length];
        // æ ¹æ®å·®åˆ†æ•°ç»„æ„é€ ç»“æœæ•°ç»„
        res[0] = diff[0];
        for (int i = 1; i < diff.length; i++) {
            res[i] = res[i - 1] + diff[i];
        }
        return res;
    }
}
```

#### 1109.èˆªç­é¢„è®¢ç»Ÿè®¡

```
è¿™é‡Œæœ‰  n  ä¸ªèˆªç­ï¼Œå®ƒä»¬åˆ†åˆ«ä» 1 åˆ° n è¿›è¡Œç¼–å·ã€‚

[i, j, k] å…¶å®ä»£è¡¨çš„æ˜¯ ç¬¬ i ç«™ä¸Šæ¥äº† k ä¸ªäººï¼Œ ä¸€ç›´åˆ° ç¬¬ j ç«™éƒ½åœ¨é£æœºä¸Šï¼Œåˆ°ç¬¬ j + 1 å°±ä¸åœ¨é£æœºä¸Šäº†ã€‚æ‰€ä»¥ç¬¬ i ç«™åˆ°ç¬¬ j ç«™çš„æ¯ä¸€ç«™éƒ½ä¼šå› æ­¤å¤š k ä¸ªäººã€‚

è¯·ä½ è¿”å›ä¸€ä¸ªé•¿åº¦ä¸º n çš„æ•°ç»„  answerï¼ŒæŒ‰èˆªç­ç¼–å·é¡ºåºè¿”å›æ¯ä¸ªèˆªç­ä¸Šé¢„è®¢çš„åº§ä½æ•°ã€‚

è¾“å…¥ï¼šbookings = [[1,2,10],[2,3,20],[2,5,25]], n = 5

è¾“å‡ºï¼š[10,55,45,25,25]

æç¤ºï¼š

1 <= bookings.length <= 20000

1 <= bookings[i][0] <= bookings[i][1] <= n <= 20000

1 <= bookings[i][2] <= 10000
```

---

è¿™ä¸ªé¢˜ç›®å°±åœ¨é‚£ç»•å¼¯å¼¯ï¼Œå…¶å®å®ƒå°±æ˜¯ä¸ªå·®åˆ†æ•°ç»„çš„é¢˜ï¼Œæˆ‘ç»™ä½ ç¿»è¯‘ä¸€ä¸‹ï¼š

ç»™ä½ è¾“å…¥ä¸€ä¸ªé•¿åº¦ä¸º`n`çš„æ•°ç»„`nums`ï¼Œå…¶ä¸­æ‰€æœ‰å…ƒç´ éƒ½æ˜¯ 0ã€‚å†ç»™ä½ è¾“å…¥ä¸€ä¸ª`bookings`ï¼Œé‡Œé¢æ˜¯è‹¥å¹²ä¸‰å…ƒç»„`(i,j,k)`ï¼Œæ¯ä¸ªä¸‰å…ƒç»„çš„å«ä¹‰å°±æ˜¯è¦æ±‚ä½ ç»™`nums`æ•°ç»„çš„é—­åŒºé—´`[i-1,j-1]`ä¸­æ‰€æœ‰å…ƒç´ éƒ½åŠ ä¸Š`k`ã€‚è¯·ä½ è¿”å›æœ€åçš„`nums`æ•°ç»„æ˜¯å¤šå°‘ï¼Ÿ

è¿™ä¹ˆä¸€çœ‹ï¼Œä¸å°±æ˜¯ä¸€é“æ ‡å‡†çš„å·®åˆ†æ•°ç»„é¢˜å˜›ï¼Ÿæˆ‘ä»¬å¯ä»¥ç›´æ¥å¤ç”¨åˆšæ‰çš„ä»£ç ï¼š

é‚£ä¹ˆå¯¹äº å¤šä¸ªåŒºé—´ï¼Œæˆ‘ä»¬åªéœ€è¦å åŠ èµ·æ¥å³å¯

![image.png](assets/af76e333b5d4ab9b05fdee0276c0aa4c9b0a88f15b47396c9ecd47d88e58c5a2-image.png)

```c
class Solution {
    public int[] corpFlightBookings(int[][] bookings, int n) {
        // å·®åˆ†æ•°ç»„
        int[] diff = new int[n];
        int[] nums = new int[n];
        for (int[] booking : bookings) {
            // æ³¨æ„è½¬æˆæ•°ç»„ç´¢å¼•è¦å‡ä¸€å“¦
            int i = booking[0] - 1;
            int j = booking[1] - 1;
            int val = booking[2];
            diff[i] += val;
            if (j + 1 < n) {
                diff[j + 1] -= val;
            }
        }
        nums[0] = diff[0];
        for (int i = 1; i < n; i++) {
            nums[i] = nums[i - 1] + diff[i];
        }
        // è¿”å›æœ€ç»ˆçš„ç»“æœæ•°ç»„
        return nums;
    }
}

```

æ—¶é—´å¤æ‚åº¦ï¼š$O(N)$ï¼Œä¸­ $N$ ä¸ºæ•°ç»„é•¿åº¦ã€‚

ç©ºé—´å¤æ‚åº¦ï¼š$O(N)$ã€‚

# å•è°ƒé˜Ÿåˆ—

è¿™ä¸ªæ•°æ®ç»“æ„æœ‰ä»€ä¹ˆç”¨ï¼Ÿå¯ä»¥è§£å†³æ»‘åŠ¨çª—å£çš„ä¸€ç³»åˆ—é—®é¢˜ã€‚

## [239.æ»‘åŠ¨çª—å£æœ€å¤§å€¼](https://leetcode-cn.com/problems/sliding-window-maximum)

<img src="E:\11 ä¸ªäººè¿›æ­¥\01 ä¸ªäººæ€»ç»“\LeetCodeåˆ·é¢˜\assets\image-20210519175344824.png" alt="image-20210519175344824" style="zoom: 80%;" />

### ä¸€ã€æ­å»ºè§£é¢˜æ¡†æ¶

åœ¨ä¸€å †æ•°å­—ä¸­ï¼Œå·²çŸ¥æœ€å€¼ï¼Œå¦‚æœç»™è¿™å †æ•°æ·»åŠ ä¸€ä¸ªæ•°ï¼Œé‚£ä¹ˆæ¯”è¾ƒä¸€ä¸‹å°±å¯ä»¥å¾ˆå¿«ç®—å‡ºæœ€å€¼ï¼›ä½†å¦‚æœå‡å°‘ä¸€ä¸ªæ•°ï¼Œå°±ä¸ä¸€å®šèƒ½å¾ˆå¿«å¾—åˆ°æœ€å€¼äº†ï¼Œè€Œè¦éå†æ‰€æœ‰æ•°é‡æ–°æ‰¾æœ€å€¼ã€‚

ä¸€ä¸ªã€Œå•è°ƒé˜Ÿåˆ—ã€çš„æ“ä½œä¹Ÿå·®ä¸å¤šï¼š

```java
class MonotonicQueue {
    // åœ¨é˜Ÿå°¾æ·»åŠ å…ƒç´  n
    void push(int n);
    // è¿”å›å½“å‰é˜Ÿåˆ—ä¸­çš„æœ€å¤§å€¼
    int max();
    // é˜Ÿå¤´å…ƒç´ å¦‚æœæ˜¯ nï¼Œåˆ é™¤å®ƒ
    void pop(int n);
}
```



å½“ç„¶ï¼Œè¿™å‡ ä¸ª API çš„å®ç°æ–¹æ³•è‚¯å®šè·Ÿä¸€èˆ¬çš„ Queue ä¸ä¸€æ ·ï¼Œä¸è¿‡æˆ‘ä»¬æš‚ä¸”ä¸ç®¡ï¼Œè€Œä¸”è®¤ä¸ºè¿™å‡ ä¸ªæ“ä½œçš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ O(1)ï¼Œå…ˆæŠŠè¿™é“ã€Œæ»‘åŠ¨çª—å£ã€é—®é¢˜çš„è§£ç­”æ¡†æ¶æ­å‡ºæ¥ï¼š

```java
vector<int> maxSlidingWindow(vector<int>& nums, int k) {
    MonotonicQueue window;
    vector<int> res;
    for (int i = 0; i < nums.size(); i++) {
        if (i < k - 1) { //å…ˆæŠŠçª—å£çš„å‰ k - 1 å¡«æ»¡
            window.push(nums[i]);
        } else { // çª—å£å¼€å§‹å‘å‰æ»‘åŠ¨
            window.push(nums[i]);
            res.push_back(window.max());
            window.pop(nums[i - k + 1]); //i-k+1ç›¸å½“äºleftå˜é‡
            // nums[i - k + 1] å°±æ˜¯çª—å£æœ€åçš„å…ƒç´ 
        }
    }
    return res;
}
```

### äºŒã€å®ç°å•è°ƒé˜Ÿåˆ—æ•°æ®ç»“æ„

ã€Œå•è°ƒé˜Ÿåˆ—ã€çš„æ ¸å¿ƒæ€è·¯å’Œã€Œå•è°ƒæ ˆã€ç±»ä¼¼ã€‚å•è°ƒé˜Ÿåˆ—çš„ push æ–¹æ³•ä¾ç„¶åœ¨é˜Ÿå°¾æ·»åŠ å…ƒç´ ï¼Œä½†æ˜¯è¦æŠŠå‰é¢æ¯”æ–°å…ƒç´ å°çš„å…ƒç´ éƒ½åˆ æ‰ï¼š

```java
class MonotonicQueue {
private:
    deque<int> data;
public:
    void push(int n) {
        while (!data.empty() && data.back() < n) 
            data.pop_back();
        data.push_back(n);
    }
};
```

å¦‚æœæ¯ä¸ªå…ƒç´ è¢«åŠ å…¥æ—¶éƒ½è¿™æ ·æ“ä½œï¼Œæœ€ç»ˆå•è°ƒé˜Ÿåˆ—ä¸­çš„å…ƒç´ å¤§å°å°±ä¼šä¿æŒä¸€ä¸ªå•è°ƒé€’å‡çš„é¡ºåºï¼Œå› æ­¤æˆ‘ä»¬çš„ max() API å¯ä»¥å¯ä»¥è¿™æ ·å†™ï¼š

```java
int max() {
    return data.front();
}
```

pop() API åœ¨é˜Ÿå¤´åˆ é™¤å…ƒç´  nï¼Œä¹Ÿå¾ˆå¥½å†™ï¼š

```java
void pop(int n) {
    if (!data.empty() && data.front() == n)
        data.pop_front();
}
```

ä¹‹æ‰€ä»¥è¦åˆ¤æ–­ `data.front() == n`ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬æƒ³åˆ é™¤çš„é˜Ÿå¤´å…ƒç´  n å¯èƒ½å·²ç»è¢«ã€Œå‹æ‰ã€äº†ï¼Œè¿™æ—¶å€™å°±ä¸ç”¨åˆ é™¤äº†ï¼š

è‡³æ­¤ï¼Œå•è°ƒé˜Ÿåˆ—è®¾è®¡å®Œæ¯•ï¼Œçœ‹ä¸‹å®Œæ•´çš„è§£é¢˜ä»£ç ï¼š

```java
class MonotonicQueue {
private:
    deque<int> data;
public:
    void push(int n) {
        while (!data.empty() && data.back() < n) 
            data.pop_back();
        data.push_back(n);
    }
    
    int max() { return data.front(); }
    
    void pop(int n) {
        if (!data.empty() && data.front() == n)
            data.pop_front();
    }
};

vector<int> maxSlidingWindow(vector<int>& nums, int k) {
    MonotonicQueue window;
    vector<int> res;
    for (int i = 0; i < nums.size(); i++) {
        if (i < k - 1) { //å…ˆå¡«æ»¡çª—å£çš„å‰ k - 1
            window.push(nums[i]);
        } else { // çª—å£å‘å‰æ»‘åŠ¨
            window.push(nums[i]);
            res.push_back(window.max());
            window.pop(nums[i - k + 1]);
        }
    }
    return res;
}
```

**å››ã€æœ€åæ€»ç»“**

æœ‰çš„è¯»è€…å¯èƒ½è§‰å¾—ã€Œå•è°ƒé˜Ÿåˆ—ã€å’Œã€Œä¼˜å…ˆçº§é˜Ÿåˆ—ã€æ¯”è¾ƒåƒï¼Œå®é™…ä¸Šå·®åˆ«å¾ˆå¤§çš„ã€‚

å•è°ƒé˜Ÿåˆ—åœ¨æ·»åŠ å…ƒç´ çš„æ—¶å€™é åˆ é™¤å…ƒç´ ä¿æŒé˜Ÿåˆ—çš„å•è°ƒæ€§ï¼Œç›¸å½“äºæŠ½å–å‡ºæŸä¸ªå‡½æ•°ä¸­å•è°ƒé€’å¢ï¼ˆæˆ–é€’å‡ï¼‰çš„éƒ¨åˆ†ï¼›è€Œä¼˜å…ˆçº§é˜Ÿåˆ—ï¼ˆäºŒå‰å †ï¼‰ç›¸å½“äºè‡ªåŠ¨æ’åºï¼Œå·®åˆ«å¤§äº†å»äº†ã€‚

# å·®åˆ†æ•°ç»„

æœªå®Œå¾…ç»­ã€‚ã€‚ã€‚

# ç»ƒä¹ é¢˜

## æ»‘åŠ¨çª—å£ç»ƒä¹ é¢˜ç›®

#### [438.æ‰¾åˆ°å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å­—æ¯å¼‚ä½è¯](https://leetcode-cn.com/problems/find-all-anagrams-in-a-string)

ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² s å’Œä¸€ä¸ªéç©ºå­—ç¬¦ä¸² tï¼Œæ‰¾åˆ° s ä¸­æ‰€æœ‰æ˜¯ t çš„å­—æ¯å¼‚ä½è¯çš„å­ä¸²ï¼Œè¿”å›è¿™äº›å­ä¸²çš„èµ·å§‹ç´¢å¼•ã€‚

å­—ç¬¦ä¸²åªåŒ…å«å°å†™è‹±æ–‡å­—æ¯ï¼Œå¹¶ä¸”å­—ç¬¦ä¸² s å’Œ t çš„é•¿åº¦éƒ½ä¸è¶…è¿‡ 20100ã€‚

è¯´æ˜ï¼š

å­—æ¯å¼‚ä½è¯æŒ‡å­—æ¯ç›¸åŒï¼Œä½†æ’åˆ—ä¸åŒçš„å­—ç¬¦ä¸²ã€‚
ä¸è€ƒè™‘ç­”æ¡ˆè¾“å‡ºçš„é¡ºåºã€‚

è¾“å…¥:
s: "cbaebabacd" p: "abc"
è¾“å‡º:
[0, 6]
è§£é‡Š:
èµ·å§‹ç´¢å¼•ç­‰äº 0 çš„å­ä¸²æ˜¯ "cba", å®ƒæ˜¯ "abc" çš„å­—æ¯å¼‚ä½è¯ã€‚
èµ·å§‹ç´¢å¼•ç­‰äº 6 çš„å­ä¸²æ˜¯ "bac", å®ƒæ˜¯ "abc" çš„å­—æ¯å¼‚ä½è¯ã€‚

---

å­—æ¯å¼‚ä½è¯å°±æ˜¯æ’åˆ—ï¼Œè·Ÿ[567.å­—ç¬¦ä¸²çš„æ’åˆ—](https://leetcode-cn.com/problems/permutation-in-string)çš„åŒºåˆ«æ˜¯å‡½æ•°è¿”å›å€¼ä¸åŒã€‚

å®Œæ•´ä»£ç 

```java
class Solution {
public:
    // æ‰¾sä¸­æ‰€æœ‰pçš„å¼‚å‘³è¯
    vector<int> findAnagrams(string s, string t)
    {
        unordered_map<char, int> need, window;
        for (char c : t)
            need[c]++;

        int valid = 0;
        vector<int> ret;
        for (int left = 0, right = 0; right < s.size(); right++) {
            char c = s[right];
            window[c]++;
            if (need.count(c) && need[c] == window[c]) {
                valid++;
            }
            while (valid == need.size()) {
                // åœ¨è¿™é‡Œåˆ¤æ–­æ˜¯å¦æ‰¾åˆ°äº†åˆæ³•çš„å­ä¸²
                if (right - left + 1 == t.size()) {
                    ret.push_back(left);
                }
                char d = s[left];
                window[d]--;
                if (need.count(d) && need[d] > window[d]) {
                    valid--;
                }
                left++;
            }
        }
        return ret;
    }
};
```

#### [159.è‡³å¤šåŒ…å«ä¸¤ä¸ªä¸åŒå­—ç¬¦çš„æœ€é•¿å­ä¸²](https://leetcode-cn.com/problems/longest-substring-with-at-most-two-distinct-characters/)

ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² s ï¼Œæ‰¾å‡º è‡³å¤š åŒ…å«ä¸¤ä¸ªä¸åŒå­—ç¬¦çš„æœ€é•¿å­ä¸² t ï¼Œå¹¶è¿”å›è¯¥å­ä¸²çš„é•¿åº¦ã€‚

ç¤ºä¾‹ 1:

```text
è¾“å…¥: "eceba"
è¾“å‡º: 3
è§£é‡Š: t æ˜¯ "ece"ï¼Œé•¿åº¦ä¸º3ã€‚
```

ç¤ºä¾‹ 2:

```text
è¾“å…¥: "ccaabbb"
è¾“å‡º: 5
è§£é‡Š: t æ˜¯ "aabbb"ï¼Œé•¿åº¦ä¸º5ã€‚
```

- `1 <= tree.length <= 40000`
- `0 <= tree[i] < tree.length`

---

æœ€å¤šåŒ…å«ä¸¤ä¸ªä¸åŒå­—ç¬¦ä¸€å®šæ˜¯é—®ã€Œæœ€é•¿ã€ï¼Œè€Œä¸ä¼šé—®ã€Œæœ€çŸ­ã€ï¼Œå› ä¸ºæœ€çŸ­æ˜¯ä¸€ä¸ªå­—ç¬¦ï¼ŒåªåŒ…å«è‡ªèº«ã€‚

æ ¹æ®é¢˜æ„,**æ»‘åŠ¨çª—å£ç®—æ³•çš„æ€è·¯æ˜¯è¿™æ ·**ï¼š

1.çª—å£åˆå§‹åŒ– `left = right = 0`ï¼Œçª—å£ä¸º[left,right];

2.å…ˆä½¿ç”¨rightæŒ‡é’ˆæ‰©å¤§çª—å£;

3.å½“çª—å£å­—ç¬¦ä¸²ä¸æ»¡è¶³æ¡ä»¶æ—¶(åŒ…å«è¶…è¿‡ä¸¤ä¸ªä¸åŒå­—ç¬¦)ï¼Œä½¿ç”¨leftæŒ‡é’ˆç¼©å°çª—å£ï¼Œç›´åˆ°çª—å£å­—ç¬¦ä¸²æ»¡è¶³æ¡ä»¶(æœ€å¤šåŒ…å«ä¸¤ä¸ªä¸åŒå­—ç¬¦)ï¼Œæ”¶ç¼©çª—å£å®Œæˆåæ›´æ–°resï¼›

4.é‡å¤ç¬¬ 2 å’Œç¬¬ 3 æ­¥ï¼Œç›´åˆ° `right` åˆ°è¾¾å­—ç¬¦ä¸²çš„å°¾éƒ¨ã€‚

ä»£ç ï¼š

```c
class Solution {
public:
    int totalFruit(vector<int> &tree)
    {
        unordered_map<int, int> window;
        const int k = 2;
        int res = 0;
        int left = 0, right = 0;
        for (; right < tree.size(); right++) {
            window[tree[right]]++;
            while (window.size() > k) {// åˆ¤æ–­å·¦ä¾§çª—å£æ˜¯å¦è¦æ”¶ç¼©
                window[tree[left]]--;
                if (window[tree[left]] == 0) {
                    window.erase(tree[left]);
                }
                left++;
            }
            // åœ¨è¿™é‡Œæ›´æ–°ç­”æ¡ˆ
            res = max(res, right - left + 1);
        }
        return res;
    }
};

//ä½¿ç”¨validä¼šå¯¼è‡´windowè¿‡å¤§ï¼Œleetcodeæäº¤è¶…æ—¶
class Solution {
public:
    int lengthOfLongestSubstring(string s)
    {
        unordered_map<char, int> need, window;
        int ret = 0;
        int valid = 0;  //è®°å½•çª—å£ä¸­æœ‰å‡ ä¸ªä¸åŒçš„å­—ç¬¦
        for (int left = 0, right = 0; right < s.size(); right++) {
            char c = s[right];
            window[c]++;
            if (window[c] == 1) {
                valid++;
            }
            // åˆ¤æ–­å·¦ä¾§çª—å£æ˜¯å¦è¦æ”¶ç¼©
            while (valid > 2) {
                char c2 = s[left];
                window[c2]--;
                if (window[c2] == 0) {
                    valid--;
                }
                left++;
            }
            // åœ¨è¿™é‡Œæ›´æ–°ç­”æ¡ˆ
            ret = max(ret , right - left + 1);
            cout << "left=" << left << ",right=" << right << ",ret=" << ret << endl;
        }
        return ret;
    }
};
```

#### 904.æ°´æœæˆç¯®



åœ¨ä¸€æ’æ ‘ä¸­ï¼Œç¬¬ i æ£µæ ‘äº§ç”Ÿ tree[i] å‹çš„æ°´æœã€‚
ä½ å¯ä»¥ä»ä½ é€‰æ‹©çš„ä»»ä½•æ ‘å¼€å§‹ï¼Œç„¶åé‡å¤æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š

æŠŠè¿™æ£µæ ‘ä¸Šçš„æ°´æœæ”¾è¿›ä½ çš„ç¯®å­é‡Œã€‚å¦‚æœä½ åšä¸åˆ°ï¼Œå°±åœä¸‹æ¥ã€‚
ç§»åŠ¨åˆ°å½“å‰æ ‘å³ä¾§çš„ä¸‹ä¸€æ£µæ ‘ã€‚å¦‚æœå³è¾¹æ²¡æœ‰æ ‘ï¼Œå°±åœä¸‹æ¥ã€‚
è¯·æ³¨æ„ï¼Œåœ¨é€‰æ‹©ä¸€é¢—æ ‘åï¼Œä½ æ²¡æœ‰ä»»ä½•é€‰æ‹©ï¼šä½ å¿…é¡»æ‰§è¡Œæ­¥éª¤ 1ï¼Œç„¶åæ‰§è¡Œæ­¥éª¤ 2ï¼Œç„¶åè¿”å›æ­¥éª¤ 1ï¼Œç„¶åæ‰§è¡Œæ­¥éª¤ 2ï¼Œä¾æ­¤ç±»æ¨ï¼Œç›´è‡³åœæ­¢ã€‚

ä½ æœ‰ä¸¤ä¸ªç¯®å­ï¼Œæ¯ä¸ªç¯®å­å¯ä»¥æºå¸¦ä»»ä½•æ•°é‡çš„æ°´æœï¼Œä½†ä½ å¸Œæœ›æ¯ä¸ªç¯®å­åªæºå¸¦ä¸€ç§ç±»å‹çš„æ°´æœã€‚

ç”¨è¿™ä¸ªç¨‹åºä½ èƒ½æ”¶é›†çš„æ°´æœæ ‘çš„æœ€å¤§æ€»é‡æ˜¯å¤šå°‘ï¼Ÿ



ç¤ºä¾‹ 1ï¼š

è¾“å…¥ï¼š[1,2,1]
è¾“å‡ºï¼š3
è§£é‡Šï¼šæˆ‘ä»¬å¯ä»¥æ”¶é›† [1,2,1]ã€‚
ç¤ºä¾‹ 2ï¼š

è¾“å…¥ï¼š[0,1,2,2]
è¾“å‡ºï¼š3
è§£é‡Šï¼šæˆ‘ä»¬å¯ä»¥æ”¶é›† [1,2,2]
å¦‚æœæˆ‘ä»¬ä»ç¬¬ä¸€æ£µæ ‘å¼€å§‹ï¼Œæˆ‘ä»¬å°†åªèƒ½æ”¶é›†åˆ° [0, 1]ã€‚
ç¤ºä¾‹ 3ï¼š

è¾“å…¥ï¼š[1,2,3,2,2]
è¾“å‡ºï¼š4
è§£é‡Šï¼šæˆ‘ä»¬å¯ä»¥æ”¶é›† [2,3,2,2]
å¦‚æœæˆ‘ä»¬ä»ç¬¬ä¸€æ£µæ ‘å¼€å§‹ï¼Œæˆ‘ä»¬å°†åªèƒ½æ”¶é›†åˆ° [1, 2]ã€‚
ç¤ºä¾‹ 4ï¼š

è¾“å…¥ï¼š[3,3,3,1,2,1,1,2,3,3,4]
è¾“å‡ºï¼š5
è§£é‡Šï¼šæˆ‘ä»¬å¯ä»¥æ”¶é›† [1,2,1,1,2]
å¦‚æœæˆ‘ä»¬ä»ç¬¬ä¸€æ£µæ ‘æˆ–ç¬¬å…«æ£µæ ‘å¼€å§‹ï¼Œæˆ‘ä»¬å°†åªèƒ½æ”¶é›†åˆ° 4 æ£µæ°´æœæ ‘ã€‚


æç¤ºï¼š

1 <= tree.length <= 40000
0 <= tree[i] < tree.length

---

æœ¬è´¨æ˜¯æ±‚æœ€å¤šåŒ…å«ä¸¤ä¸ªï¼ˆk=2ï¼‰ä¸åŒå­—ç¬¦çš„æ»‘çª—çª—å£å¤§å°,ç­”æ¡ˆå’Œ[159.è‡³å¤šåŒ…å«ä¸¤ä¸ªä¸åŒå­—ç¬¦çš„æœ€é•¿å­ä¸²](https://leetcode-cn.com/problems/longest-substring-with-at-most-two-distinct-characters/)ä¸€æ¨¡ä¸€æ ·ï¼Œä¸å†èµ˜è¿°ã€‚

#### [209.é•¿åº¦æœ€å°çš„å­æ•°ç»„](https://leetcode-cn.com/problems/minimum-size-subarray-sum/)

ç»™å®šä¸€ä¸ªå«æœ‰ n ä¸ª**æ­£æ•´æ•°**çš„æ•°ç»„å’Œä¸€ä¸ªæ­£æ•´æ•° target ã€‚

æ‰¾å‡ºè¯¥æ•°ç»„ä¸­æ»¡è¶³å…¶å’Œ â‰¥ target çš„é•¿åº¦æœ€å°çš„ è¿ç»­å­æ•°ç»„ [numsl, numsl+1, ..., numsr-1, numsr] ï¼Œå¹¶è¿”å›å…¶é•¿åº¦ã€‚å¦‚æœä¸å­˜åœ¨ç¬¦åˆæ¡ä»¶çš„å­æ•°ç»„ï¼Œè¿”å› 0 ã€‚

 

ç¤ºä¾‹ 1ï¼š

è¾“å…¥ï¼štarget = 7, nums = [2,3,1,2,4,3]
è¾“å‡ºï¼š2
è§£é‡Šï¼šå­æ•°ç»„ [4,3] æ˜¯è¯¥æ¡ä»¶ä¸‹çš„é•¿åº¦æœ€å°çš„å­æ•°ç»„ã€‚

**æç¤ºï¼š**

- `1 <= target <= 10^9`
- `1 <= nums.length <= 10^5`
- `1 <= nums[i] <= 10^5`

`tips`:   $2^{32}/10^9 = 1.4 $

---

æ•°ç»„å€¼ä¸ºæ­£æ•´æ•°ï¼Œæ±‚æ•°ç»„å’Œâ‰¥ target çš„å­æ•°ç»„é•¿åº¦ä¸€å®šæ˜¯é—®ã€Œæœ€å°ã€ï¼Œè€Œä¸ä¼šé—®ã€Œæœ€å¤§ã€ï¼Œå› ä¸ºæœ€å¤§æ˜¯æ•´ä¸ªæ•°ç»„ã€‚

æ ¹æ®é¢˜æ„,**æ»‘åŠ¨çª—å£ç®—æ³•çš„æ€è·¯æ˜¯è¿™æ ·**ï¼š

1.çª—å£åˆå§‹åŒ– `left = right = 0`ï¼Œçª—å£ä¸º[left,right];

2.å…ˆä½¿ç”¨rightæŒ‡é’ˆæ‰©å¤§çª—å£;

3.å½“çª—å£æ•°ç»„æ»¡è¶³æ¡ä»¶æ—¶(æ•°ç»„å’Œâ‰¥ target),ä½¿ç”¨leftæŒ‡é’ˆç¼©å°çª—å£ï¼Œç›´åˆ°çª—å£ä¸­çš„æ•°ç»„ä¸ç¬¦åˆè¦æ±‚ï¼ˆæ•°ç»„å’Œ< targetï¼‰ï¼Œæ”¶ç¼©çª—å£çš„åŒæ—¶æ›´æ–°æ•°ç»„æœ€å°é•¿åº¦ï¼›

4.é‡å¤ç¬¬ 2 å’Œç¬¬ 3 æ­¥ï¼Œç›´åˆ° `right` åˆ°è¾¾æ•°ç»„çš„å°¾éƒ¨ã€‚

```c
class Solution {
    public int minSubArrayLen(int target, int[] nums) {
        // æ»‘åŠ¨çª—å£
        int left = 0;
        int right = 0;
        int sum = 0;
        int minLen = Integer.MAX_VALUE;
        while (right < nums.length) {
            sum += nums[right];
            while (sum >= target) {
                minLen = Math.min(minLen, right - left + 1);
                sum -= nums[left];
                left++;
            }
            right++;
        }
        return minLen == Integer.MAX_VALUE ? 0 : minLen;
    }
}
```

## å‰ç¼€å’Œç»ƒä¹ é¢˜

#### [303. åŒºåŸŸå’Œæ£€ç´¢ - æ•°ç»„ä¸å¯å˜](https://leetcode-cn.com/problems/range-sum-query-immutable/description/)

ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„  numsï¼Œæ±‚å‡ºæ•°ç»„ä»ç´¢å¼• i åˆ° jï¼ˆi â‰¤ jï¼‰èŒƒå›´å†…å…ƒç´ çš„æ€»å’Œï¼ŒåŒ…å« iã€j ä¸¤ç‚¹ã€‚

å®ç° NumArray ç±»ï¼š

```c
å°±æ˜¯æ¯é¢˜0åŸå‹
```

#### [1171. ä»é“¾è¡¨ä¸­åˆ å»æ€»å’Œå€¼ä¸ºé›¶çš„è¿ç»­èŠ‚ç‚¹](https://leetcode-cn.com/problems/remove-zero-sum-consecutive-nodes-from-linked-list/)

ç»™ä½ ä¸€ä¸ªé“¾è¡¨çš„å¤´èŠ‚ç‚¹ headï¼Œè¯·ä½ ç¼–å†™ä»£ç ï¼Œåå¤åˆ å»é“¾è¡¨ä¸­ç”± æ€»å’Œ å€¼ä¸º 0 çš„è¿ç»­èŠ‚ç‚¹ç»„æˆçš„åºåˆ—ï¼Œç›´åˆ°ä¸å­˜åœ¨è¿™æ ·çš„åºåˆ—ä¸ºæ­¢ã€‚

åˆ é™¤å®Œæ¯•åï¼Œè¯·ä½ è¿”å›æœ€ç»ˆç»“æœé“¾è¡¨çš„å¤´èŠ‚ç‚¹ã€‚

 

ä½ å¯ä»¥è¿”å›ä»»ä½•æ»¡è¶³é¢˜ç›®è¦æ±‚çš„ç­”æ¡ˆã€‚

ï¼ˆæ³¨æ„ï¼Œä¸‹é¢ç¤ºä¾‹ä¸­çš„æ‰€æœ‰åºåˆ—ï¼Œéƒ½æ˜¯å¯¹ ListNode å¯¹è±¡åºåˆ—åŒ–çš„è¡¨ç¤ºã€‚ï¼‰

ç¤ºä¾‹ 1ï¼š

è¾“å…¥ï¼šhead = [1,2,-3,3,1]
è¾“å‡ºï¼š[3,1]
æç¤ºï¼šç­”æ¡ˆ [1,2,1] ä¹Ÿæ˜¯æ­£ç¡®çš„ã€‚
ç¤ºä¾‹ 2ï¼š

è¾“å…¥ï¼šhead = [1,2,3,-3,4]
è¾“å‡ºï¼š[1,2,4]
ç¤ºä¾‹ 3ï¼š

è¾“å…¥ï¼šhead = [1,2,3,-3,-2]
è¾“å‡ºï¼š[1]


æç¤ºï¼š

ç»™ä½ çš„é“¾è¡¨ä¸­å¯èƒ½æœ‰ 1 åˆ° 1000 ä¸ªèŠ‚ç‚¹ã€‚
å¯¹äºé“¾è¡¨ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹çš„å€¼ï¼š-1000 <= node.val <= 1000.

---

#### [1186.åˆ é™¤ä¸€æ¬¡å¾—åˆ°å­æ•°ç»„æœ€å¤§å’Œ](https://lucifer.ren/blog/2019/12/11/leetcode-1186/)

#### [1310. å­æ•°ç»„å¼‚æˆ–æŸ¥è¯¢](https://lucifer.ren/blog/2020/01/09/1310.xor-queries-of-a-subarray/)

#### [1371. æ¯ä¸ªå…ƒéŸ³åŒ…å«å¶æ•°æ¬¡çš„æœ€é•¿å­å­—ç¬¦ä¸²](https://github.com/azl397985856/leetcode/blob/master/problems/1371.find-the-longest-substring-containing-vowels-in-even-counts.md)

#### [1402. åšèœé¡ºåº](https://leetcode-cn.com/problems/reducing-dishes/)

#### [1094. æ‹¼è½¦](https://leetcode-cn.com/problems/car-pooling/)

å‡è®¾ä½ æ˜¯ä¸€ä½é¡ºé£è½¦å¸æœºï¼Œè½¦ä¸Šæœ€åˆæœ‰ capacity ä¸ªç©ºåº§ä½å¯ä»¥ç”¨æ¥è½½å®¢ã€‚

è¿™å„¿æœ‰ä¸€ä»½ä¹˜å®¢è¡Œç¨‹è®¡åˆ’è¡¨ trips[][]ï¼Œå…¶ä¸­ trips[i] = [num_passengers, start_location, end_location] åŒ…å«äº†ç¬¬ i ç»„ä¹˜å®¢çš„è¡Œç¨‹ä¿¡æ¯ï¼š

å¿…é¡»æ¥é€çš„ä¹˜å®¢æ•°é‡ï¼›
ä¹˜å®¢çš„ä¸Šè½¦åœ°ç‚¹ï¼›
ä»¥åŠä¹˜å®¢çš„ä¸‹è½¦åœ°ç‚¹ã€‚
è¿™äº›ç»™å‡ºçš„åœ°ç‚¹ä½ç½®æ˜¯ä»ä½ çš„ åˆå§‹ å‡ºå‘ä½ç½®å‘å‰è¡Œé©¶åˆ°è¿™äº›åœ°ç‚¹æ‰€éœ€çš„è·ç¦»ï¼ˆå®ƒä»¬ä¸€å®šåœ¨ä½ çš„è¡Œé©¶æ–¹å‘ä¸Šï¼‰ã€‚

è¯·ä½ æ ¹æ®ç»™å‡ºçš„è¡Œç¨‹è®¡åˆ’è¡¨å’Œè½¦å­çš„åº§ä½æ•°ï¼Œæ¥åˆ¤æ–­ä½ çš„è½¦æ˜¯å¦å¯ä»¥é¡ºåˆ©å®Œæˆæ¥é€æ‰€æœ‰ä¹˜å®¢çš„ä»»åŠ¡ï¼ˆå½“ä¸”ä»…å½“ä½ å¯ä»¥åœ¨æ‰€æœ‰ç»™å®šçš„è¡Œç¨‹ä¸­æ¥é€æ‰€æœ‰ä¹˜å®¢æ—¶ï¼Œè¿”å› trueï¼Œå¦åˆ™è¯·è¿”å› falseï¼‰ã€‚

 

ç¤ºä¾‹ 1ï¼š

è¾“å…¥ï¼štrips = [[2,1,5],[3,3,7]], capacity = 4
è¾“å‡ºï¼šfalse



//å’Œ1109.èˆªç­é¢„è®¢ç»Ÿè®¡æ€è·¯ä¸€æ ·,åŒºåˆ«æ˜¯åˆ¤æ–­resæ•°ç»„æ‰€æœ‰å€¼å‡å°äºcapacityå³è¿”å›true

```python
class Solution {
    public boolean carPooling(int[][] trips, int capacity) {
        
    }
}

```



# 